cscope 15 /media/data2/home/nick/phdwork               0000061041
	@4-5-2022.py

1 
impÜt
 
	gm©¶Ùlib
.
py¶Ù
 
as
 
¶t


2 
impÜt
 
numpy
 
as
 
Å


3 
äom
 
	gskË¬n
.
d©a£ts
 
impÜt
 
make_blobs


4 
äom
 
	gskË¬n
.
şu¡”
 
impÜt
 
	gKM—ns


11 
	gX
, 
	gy
, 
	gûÁ”s
 = 
make_blobs
(

12 
n_§m¶es
=20, 
n_ã©u»s
=2,

13 
ûÁ”s
=[[3,2,2,0],[1,-4,3,3] ], 
şu¡”_¡d
=0.05,

14 
shufæe
=
True
, 
¿ndom_¡©e
=0, 
»tuº_ûÁ”s
=True

18 
X
, 
	gy
, 
	gûÁ”s
 = 
	$make_blobs
(

19 
n_§m¶es
=10, 
n_ã©u»s
=2,

20 
ûÁ”s
=[ [5,5], [3,2] ], 
şu¡”_¡d
=0.5,

21 
shufæe
=
True
, 
¿ndom_¡©e
=0, 
»tuº_ûÁ”s
=True

25 
¶t
.
	`sÿ‰”
(

26 
X
[
y
 == 0, 0], X[y == 0, 1],

27 
s
=50, 
c
='lightgreen',

28 
m¬k”
='s', 
edgecŞÜ
='black',

29 
Ïb–
='cluster 1'

32 
¶t
.
	`sÿ‰”
(

33 
X
[
y
 == 1, 0], X[y == 1, 1],

34 
s
=50, 
c
='orange',

35 
m¬k”
='o', 
edgecŞÜ
='black',

36 
Ïb–
='cluster 2'

40 #¶Ù 
the
 
ûÁroids


41 
¶t
.
	`sÿ‰”
(

42 
ûÁ”s
[:, 0], centers[:, 1],

43 
s
=250, 
m¬k”
='*',

44 
c
='»d', 
edgecŞÜ
='black',

45 
Ïb–
='centroids'

48 
¶t
.
	$Ëg’d
(
sÿ‰”pošts
=1)

49 #¶t.
	`grid
()

50 #¶t.
	`show
()

52 #´št(
ûÁ”s
)

53 #¶t.
	`sÿ‰”
(
X
[:,0],X[:,1], 
c
=
y
);

54 
¶t
.
	$grid
()

55 
¶t
.
	$show
()

56 #´št(
X
)

58 #´št(
XÃw
)

60 #´št(
y
)

62 #´št(
yÃw
)

	@centers.py

1 
impÜt
 
dimod


2 
äom
 
	gdwave
.
	gsy¡em
.
compos™es
 
impÜt
 
EmbeddšgCompos™e


3 
äom
 
	gdwave
.
	gsy¡em
.
§m¶”s
 
impÜt
 
DWaveSam¶”


4 
impÜt
 
	gÃ®


6 #w
Úly
 
wªt
 
to
 
´eãr
 
¡©es
 
th©
 
¬e
 
§me
 
v®ue
 
š
 
—ch
 
qub™


7 #sØ0,0 
Ü
 1,1

10 
	gh
 = {}

12 
exaù_§m¶”
 = 
dimod
.
	$ExaùSŞv”
()

13 #§m¶” = 
	`EmbeddšgCompos™e
(
	`DWaveSam¶”
())

15 #bqm = 
dimod
.
Bš¬yQuad¿ticMod–
.
	`äom_qubo
(
Q
)

16 
bqm
 = 
dimod
.
Bš¬yQuad¿ticMod–
.
	$äom_isšg
(
h
,
J
)

18 #»¥Ú£ = 
exaù_§m¶”
.
	`§m¶e
(
bqm
, 
sw“p_size
=1000)

19 
»¥Ú£
 = 
exaù_§m¶”
.
	$§m¶e
(
bqm
)

20 #»¥Ú£ = 
§m¶”
.
	`§m¶e
(
bqm
, 
num_»ads
=10000)

22 #´št(
»¥Ú£
.
»cÜd
)

23 
	$´št
(
»¥Ú£
.
fœ¡
)

24 #´št(
»¥Ú£
.
fœ¡
.
§m¶e
)

25 #´št(
»¥Ú£
.
fœ¡
.
’”gy
)

27 #§m¶e£ˆğ
§m¶”
.
	`§m¶e_isšg
(
h
, 
J
, 
num_»ads
=1000)

29 #´št(
§m¶e£t
)

	@dwave-test.py

1 
impÜt
 
dimod


2 
äom
 
	gdwave
.
	gsy¡em
.
compos™es
 
impÜt
 
EmbeddšgCompos™e


3 
äom
 
	gdwave
.
	gsy¡em
.
§m¶”s
 
impÜt
 
	gDWaveSam¶”


5 #w
Úly
 
wªt
 
to
 
´eãr
 
¡©es
 
th©
 
¬e
 
§me
 
v®ue
 
š
 
—ch
 
qub™


6 #sØ0,0 
Ü
 1,1

9 #Usšg 64-
b™
 
hash
 
v®ues


12 
	gh
 = {}

13 
J
 = {(3891962469035829225, 261024130118881976): 0.0, (1278075525769194288, 1461127261386963019): 0.0 }

18 
§m¶”
 = 
EmbeddšgCompos™e
(
	$DWaveSam¶”
())

20 #bqm = 
dimod
.
Bš¬yQuad¿ticMod–
.
	`äom_qubo
(
Q
)

22 #»¥Ú£ = 
§m¶”
.
	`§m¶e
(
bqm
, 
num_»ads
=10000)

24 #´št(
»¥Ú£
)

26 
§m¶e£t
 = 
§m¶”
.
	$§m¶e_isšg
(
h
, 
J
, 
num_»ads
=1000)

28 
	`´št
(
§m¶e£t
)

	@kmeans.py

1 
impÜt
 
	gm©¶Ùlib
.
py¶Ù
 
as
 
¶t


2 
impÜt
 
numpy
 
as
 
Å


3 
äom
 
	gskË¬n
.
d©a£ts
 
impÜt
 
make_blobs


4 
äom
 
	gskË¬n
.
şu¡”
 
impÜt
 
	gKM—ns


7 ## 
ûÁ”
 
pošts


8 ## 
mu¡
 
be
 
of
 
size
 
n_şu¡”s
, 
n_ã©u»s


9 ## 
n_ã©u»s
 = 2

10 ## 
the
 
´obËm
 
is
, 
we
 
cÜ»¥Úd
 
ûÁroids
 
to
 
n_şu¡”s


11 ## 
so
 
we
 
Ãed
 
to
 
figu»
 
out
 
the
 
İtim®
 
numb”
 
of
 
şu¡”s


12 ## 
ResuÉs
 
wl
 
be
 
basiÿÎy
 +1, -1, 
‘c
 (1, 0)

13 ## 
maybe
 
we
 
ÿn
 
m­
 
the
 
weights
 
as
h
cÛffic›Ás


14 ## 
couÁ
 
how
 
mªy
 
have
 +1 
£t
, 
THIS
 
is
 
n_şu¡”s


15 ## 
The£
 
wl
 
®so
 
be
 
the
 
id—l
 
ûÁ”
 
pošts
, 
cŞËù
 
them


16 ## 
run
 
km—ns
/
kmedoids
 
w™h
 
the£
 
pošts


18 #´edfšed 
ûÁ”s
, 3 
x
 2 
Å¬¿y


21 
	gX
, 
	gy
 = 
	$make_blobs
(

22 
n_§m¶es
=50, 
n_ã©u»s
=2,

23 
ûÁ”s
=3, 
şu¡”_¡d
=0.5,

24 
shufæe
=
True
, 
¿ndom_¡©e
=0

27 
km
 = 
	`KM—ns
(

28 
n_şu¡”s
=3, 
š™
='random',

29 
n_š™
=10, 
max_™”
=20,

30 
tŞ
=1e-04, 
¿ndom_¡©e
=0

33 
y_km
 = 
km
.
	$f™_´ediù
(
X
)

36 #¶Ù 
the
 3 
şu¡”s


37 
¶t
.
	`sÿ‰”
(

38 
X
[
y_km
 == 0, 0], X[y_km == 0, 1],

39 
s
=50, 
c
='lightgreen',

40 
m¬k”
='s', 
edgecŞÜ
='black',

41 
Ïb–
='cluster 1'

44 
¶t
.
	`sÿ‰”
(

45 
X
[
y_km
 == 1, 0], X[y_km == 1, 1],

46 
s
=50, 
c
='orange',

47 
m¬k”
='o', 
edgecŞÜ
='black',

48 
Ïb–
='cluster 2'

51 
¶t
.
	`sÿ‰”
(

52 
X
[
y_km
 == 2, 0], X[y_km == 2, 1],

53 
s
=50, 
c
='lightblue',

54 
m¬k”
='v', 
edgecŞÜ
='black',

55 
Ïb–
='cluster 3'

58 #¶Ù 
the
 
ûÁroids


59 
¶t
.
	`sÿ‰”
(

60 
km
.
şu¡”_ûÁ”s_
[:, 0], km.cluster_centers_[:, 1],

61 
s
=250, 
m¬k”
='*',

62 
c
='»d', 
edgecŞÜ
='black',

63 
Ïb–
='centroids'

66 
	$´št
(
km
.
şu¡”_ûÁ”s_
)

67 
¶t
.
	$Ëg’d
(
sÿ‰”pošts
=1)

68 
¶t
.
	$grid
()

69 
¶t
.
	$show
()

70 
şu¡”_ûÁ”_coÜds
 = 
km
.
şu¡”_ûÁ”s_


74 3 
C’‹rs
 
this
 
fe


	@kmedoids.py

1 
impÜt
 
	gm©¶Ùlib
.
py¶Ù
 
as
 
¶t


2 
impÜt
 
numpy
 
as
 
Å


4 
äom
 
	gskË¬n_exŒa
.
şu¡”
 
impÜt
 
KMedoids


5 
äom
 
	gskË¬n
.
d©a£ts
 
impÜt
 
make_blobs


6 
äom
 
	gskË¬n
.
m‘rics
 
impÜt
 
shou‘‹_scÜe


7 
äom
 
	gskË¬n
.
m‘rics
 
impÜt
 
homog’e™y_scÜe


10 
	$´št
(
__doc__
)

13 #G’”©
§m¶e
 
d©a


14 
ûÁ”s
 = [[1, 1], [-1, -1], [1, -1]]

15 
X
, 
Ïb–s_Œue
 = 
	`make_blobs
(

16 #n_§m¶es=50, 
ûÁ”s
=ûÁ”s, 
şu¡”_¡d
=0.5, 
¿ndom_¡©e
=0

17 
n_§m¶es
=10, 
şu¡”_¡d
=0.5, 
¿ndom_¡©e
=0, 
max_™”
=2

22 #Compu‹ 
Kmedoids
 
şu¡”šg


24 #T¿š 
D©a


25 
cobj
 = 
	`KMedoids
(
n_şu¡”s
=3).
	$f™
(
X
)

27 #G‘ 
Ïb–s
 
äom
 
kmedioids


28 
Ïb–s
 = 
cobj
.
Ïb–s_


31 
unique_Ïb–s
 = 
	$£t
(
Ïb–s
)

32 
cŞÜs
 = [

33 
¶t
.
cm
.
	$S³ù¿l
(
—ch
è—ch 
š
 
Å
.
	`lš¥aû
(0, 1, 
	`Ën
(
unique_Ïb–s
))

36 #IÁršsiø
m‘hods
, 
sohou‘‹
 
scÜes


37 
s_scÜe
 = 
	$shou‘‹_scÜe
(
X
, 
Ïb–s
)

39 
k
, 
cŞ
 
š
 
	$z
(
unique_Ïb–s
, 
cŞÜs
):

41 
şass_memb”_mask
 = 
Ïb–s
 =ğ
k


43 
xy
 = 
X
[
şass_memb”_mask
]

44 
¶t
.
	`¶Ù
(

45 
xy
[:, 0],

46 
xy
[:, 1],

48 
m¬k”çûcŞÜ
=
	`tu¶e
(
cŞ
),

49 
m¬k”edgecŞÜ
="k",

50 
m¬k”size
=6,

53 
¶t
.
	`¶Ù
(

54 
cobj
.
şu¡”_ûÁ”s_
[:, 0],

55 
cobj
.
şu¡”_ûÁ”s_
[:, 1],

57 
m¬k”çûcŞÜ
="cyan",

58 
m¬k”edgecŞÜ
="k",

59 
m¬k”size
=6,

65 #¶Ù 
the
 3 
şu¡”s


66 
¶t
.
	`sÿ‰”
(

67 
X
[
cobj
 == 0, 0], X[cobj == 0, 1],

68 
s
=50, 
c
='lightgreen',

69 
m¬k”
='s', 
edgecŞÜ
='black',

70 
Ïb–
='cluster 1'

73 
¶t
.
	`sÿ‰”
(

74 
X
[
cobj
 == 1, 0], X[cobj == 1, 1],

75 
s
=50, 
c
='orange',

76 
m¬k”
='o', 
edgecŞÜ
='black',

77 
Ïb–
='cluster 2'

80 
¶t
.
	`sÿ‰”
(

81 
X
[
cobj
 == 2, 0], X[cobj == 2, 1],

82 
s
=50, 
c
='lightblue',

83 
m¬k”
='v', 
edgecŞÜ
='black',

84 
Ïb–
='cluster 3'

87 #¶Ù 
the
 
ûÁroids


88 
¶t
.
	`sÿ‰”
(

89 
cobj
.
şu¡”_ûÁ”s_
[:, 0], cobj.cluster_centers_[:, 1],

90 
s
=250, 
m¬k”
='*',

91 
c
='»d', 
edgecŞÜ
='black',

92 
Ïb–
='centroids'

96 
¶t
.
	$Ëg’d
(
sÿ‰”pošts
=1)

98 
¶t
.
	`t™Ë
("KMedoids clustering. Medoids‡re„epresented in cyan.")

99 
¶t
.
	$grid
()

100 #¶t.
	`show
()

102 #´št("Shou‘‹ ScÜe: ", 
s_scÜe
)

104 #IÃ¹Ÿ 
is
 
our
 
objeùive
 
funùiÚ
, 
low”
 i 
b‘‹r
,

105 
	`´št
("ObjeùivfunùiÚ: ", 
cobj
.
š”tŸ_
)

106 
	`´št
("Clu¡” C’‹¸CoÜdš©es: ", 
cobj
.
şu¡”_ûÁ”s_
)

110 "id": [ 
ID
 ],

113 
	}
}

116 "id": [ 
ID
 ],

122 "id": [ 
ID
 ],

128 "id": [ 
ID
 ],

134 "id": [ 
ID
 ],

141 "id": [ 
ID
 ],

147 "id": [ 
ID
 ],

153 "id": [ 
ID
 ],

159 "id": [ 
ID
 ],

	@least-squares-qubo-example.py

1 ###ORIGINAL 
CODE
 
BY
 
AJINKYA
 
BORLE
 
abÜË1
@
umbc
.
edu
 ###
‚umpy‡ Å

3 
impÜt
 
cİy


4 
impÜt
 
dimod


5 
impÜt
 
¿ndom


6 
impÜt
 
m©h


7 
äom
 
m©h
 
impÜt
 
log


8 
impÜt
 
	gdimod


10 #CÚv”t 
a
 ||
Ax
-
b
|| 
´obËm
 
što
‡ 
QUBO


11 
def
 
	$qubo_´•
(
A
,
b
,
n
,
b™¥ow”
):

13 #'
A
' ishe matrix which is‡‚p.array(),‡ matrix which is m x‚

14 #b 
is
 
the
 
veùÜ
 
š
h
ex´essiÚ
 : 
Ax
-
b
, 
ª
 
Å
.
	`¬¿y
(è
of
 
Ëngth
 
m


15 #À
is
 
ª
 
š‹g”
 
v®ue
 
th©
 i 
the
 
Ëngth
 
of
h
cŞumn
 
veùÜ
 
x


16 #b™¥ow” 
is
 
a
 
li¡
 
of
 
pow”s
 
th©
 
would
 
be
 
­¶›d
 
š
‡ 2
s
 
com¶em’t
 
way
,

17 #eg : [2,1,0] 
would
 
be
 
­¶›d
 
w™h
 
ªÙh”
 
b™
 
cked
 
Ú
 
äÚt
 
as
 : -2^(
	`Ën
(
b™¥ow”
) + 2^(2) + 2^(1) + 2^(0)

18 #NÙ: 
the
 
im¶em’tiÚ
 
»quœes
h
li¡
 
to
 
be
 
a
 
£t
 
of
 
deü—sšg
 
ªd
 
cÚ£cutive
 
numb”s
, 
sÜry
!

20 #A 
diùiÚ¬y
 
Qdiù
 
which
 
is
 
the
 
QUBO
 
this
 
´obËm


23 
n_i_ùr
 = 0

24 
i_pow”ùr
 = 0

25 
i_twosymb
 = 0

27 
pow”soáwo
 = 
Å
.
	`z”os
(
	`Ën
(
b™¥ow”
)+1)

28 
i
 
š
 
	`¿nge
(0,
	`Ën
(
b™¥ow”
)+1):

29 
i
==0:

30 
pow”soáwo
[
i
] = (2**(
b™¥ow”
[i]+1))*(-1)

32 
pow”soáwo
[
i
] = 2**(
b™¥ow”
[i-1])

34 
	`´št
("\Àpow”soáwo: ", 
pow”soáwo
)

35 
Qš™
 = 
Å
.
	$z”os
([
n
,n])

36 
Qdiù
 = {
	}
} #Sam
qubo
 
but
 
š
 
diùiÚ¬y
 
fÜm©


37 
i
 
š
 
	$¿nge
(0,
n
):

38 
j
 
š
 
	$¿nge
(
i
,
n
):

39 
Qš™
[
i
,
j
] = 2*
	$sum
(
A
[:,
i
]*A[:,
j
])

40 
bÃw
 = 2*
b


42 
	`´št
("\ÀQš™: ", 
Qš™
)

44 
i
 
š
 
	`¿nge
(0,
n
*
	$Ën
(
pow”soáwo
)):

45 
i
%
	`Ën
(
pow”soáwo
)==0 
ªd
 i>0:

46 
n_i_ùr
 =‚_i_ctr + 1

47 
i_pow”ùr
=0

48 
n_j_ùr
 = 
n_i_ùr


49 
j_pow”ùr
 = 
i_pow”ùr


50 
j
 
š
 
	`¿nge
(
i
,
n
*
	$Ën
(
pow”soáwo
)):

51 
i
==
j
:

52 
Qdiù
[
i
,i] = (
pow”soáwo
[
i_pow”ùr
]**2)*(
	`sum
(
A
[:,
n_i_ùr
]**2)è-…ow”soáwo[i_pow”ùr]*
	$sum
(
A
[:,
n_i_ùr
]*
bÃw
)

53 
	`´št
("\ÀQdiù insidfœ¡ if: \n", 
Qdiù
)

56 
j
%
	`Ën
(
pow”soáwo
)==0 
ªd
 j>0:

57 
n_j_ùr
 =‚_j_ctr + 1

58 
j_pow”ùr
 = 0

59 
Qdiù
[
i
,
j
] = 
pow”soáwo
[
i_pow”ùr
]*pow”soáwo[
j_pow”ùr
]*
Qš™
[
n_i_ùr
,
n_j_ùr
]

60 
	`´št
("\ÀQdiù insid–£‡á” fœ¡ if: \n", 
Qdiù
)

62 
j_pow”ùr
 = j_powerctr + 1

63 
i_pow”ùr
 = i_powerctr + 1

65  
Qdiù


67 #Thi 
is
 
ju¡
 
to
 
cÚv”t
 
a
 
diùiÚ¬y
 
ba£d
 
»suÉ
 
što
‡ 
bš¬y
 
¡ršg
 based„esult

68 
def
 
	$g‘_bš_¡r
(
cÚfig
,
isisšg
=
True
):

70 #cÚfig 
is
 
a
 
diùiÚ¬y


71 #isisšg 
is
 
True
 
cÚfig
 
has
 -1 
Ü
 +1 
ªd
 
F®£
 config has 0 or 1

73 #¨
bš¬y
 
¡ršg
 
of
 0
s
 
ªd
 1s

74 
bš¡r
 = ""

75 
isisšg
 =ğ
True
:

76 
i
 
š
 
	`¿nge
(0,
	$Ën
(
cÚfig
)):

77 
cÚfig
[
i
] == 1:

78 
bš¡r
 +ğ
	$¡r
(1)

79 
–if
 
cÚfig
[
i
] == -1:

80 
bš¡r
 +ğ
	$¡r
(0)

82 
i
 
š
 
	`¿nge
(0,
	$Ën
(
cÚfig
)):

83 
cÚfig
[
i
] == 1:

84 
bš¡r
 +ğ
	$¡r
(1)

85 
–if
 
cÚfig
[
i
] == 0:

86 
bš¡r
 +ğ
	$¡r
(0)

87  
bš¡r


89 #´oûs£ 
the
 
bš¬y
 
¡ršg
 
što
 
a
 
Å
.
¬¿y
 
veùÜ
.

90 
def
 
	$qubo_to_»®
(
bš¡r
,
n
,
´ec_li¡
):

91 #´•¬
the
 
pow”s_of_two
 
li¡


92 
pow”s_of_two
 = []

93 
pow”s_of_two
.
	`­³nd
(-2**(
´ec_li¡
[0]+1))

94 
i
 
š
 
	`¿nge
(0,
	$Ën
(
´ec_li¡
)):

95 
pow”s_of_two
.
	`­³nd
(2**(
´ec_li¡
[
i
]))

96 #Now 
the
 
aùu®
 
numb”


97 
bš_ùr
=0

98 
cur_»®
 = 
Å
.
	$z”os
(
n
)

99 
i
 
š
 
	$¿nge
(0,
n
):

100 
j
 
š
 
	`¿nge
(0,
	$Ën
(
pow”s_of_two
)):

101 
cur_»®
[
i
] +ğ
pow”s_of_two
[
j
]*(
bš¡r
[
bš_ùr
])

102 
bš_ùr
 += 1

104  
cur_»®


106 #Toy 
´obËm
 
lš—r
 
sy¡em
 
of
 
equ©iÚs
, 
h”e
 
m
 =ğ
n


107 #x 
wl
 
be
 
Å
.
	`¬¿y
([3,1])

109 #Deş¬
A
 
ªd
 
b


110 #Lš—¸
sy¡em
 
to
 
sŞve


111 #2
x
 + 
y
 = 7

112 #x + 3
y
 = 6

114 
A
 = 
Å
.
	$¬¿y
([[2,1],[1,3]])

115 
b
 = 
Å
.
	$¬¿y
([7,6])

116 
n
 = 2

118 
´ec_li¡
 = [1,0] #b™¥ow” 
wl
 
go
 
äom
 -4 
to
 3

119 
Q
 = 
	$qubo_´•
(
A
,
b
,
n
,
´ec_li¡
è#´•¬
qubo


121 #fÜ 
k
,
v
 
š
 
Q
.
	`™ems
():

122 #št(
k
)

123 
	`´št
("\ndiù„‘uºed by qubo_´•: \n", 
Q
, "\n")

125 #U£ 
ExaùsŞv”
 
to
 
sŞve
 
the
 
qubo


126 
§m¶”
 = 
dimod
.
	$ExaùSŞv”
()

127 
§m¶e£t
 = 
§m¶”
.
	$§m¶e_qubo
(
Q
)

129 #G‘ 
the
 
sŞutiÚ


130 
sŞn_diù
 = 
§m¶e£t
.
fœ¡
.
§m¶e


131 
	`´št
("sŞn_diù: ", 
sŞn_diù
)

132 #cÚv”ˆ
diù
 
to
 
¡ršg


133 
sŞn_bš
ğ
	$g‘_bš_¡r
(
sŞn_diù
,
isisšg
=
F®£
)

134 
	`´št
("sŞn_bš: ", 
sŞn_bš
)

135 #cÚv”ˆ
¡ršg
 
to
 
Å
.
¬¿y
 
x


136 
x
 = 
	$qubo_to_»®
(
sŞn_bš
,
n
,
´ec_li¡
)

138 
	`´št
("SŞutiÚ x i : ",
x
)

140 #IÀ
the
 
ÿ£s
 
wh”e
 
Ax
 = 
b
, ||Ax - b|| = 0 
ªd
 
®so
 ||b||^2 = 
ground
 
¡©e
 
’”gy
 
of
h
qubo


141 
	`´št
("||b||^2: ",
Å
.
lš®g
.
	`nÜm
(
b
)**2)

142 
	`´št
("EÃrgy oàsŞn: ",
§m¶e£t
.
fœ¡
.
’”gy
)

	@quadratic.py

1 
impÜt
 
numpy
 
as
 
Å


2 
impÜt
 
cİy


3 
impÜt
 
dimod


4 
impÜt
 
¿ndom


5 
impÜt
 
m©h


6 
äom
 
m©h
 
impÜt
 
log


7 
impÜt
 
dimod


8 
impÜt
 
	gm©¶Ùlib
.
py¶Ù
 
as
 
¶t


9 
äom
 
	gskË¬n
.
d©a£ts
 
impÜt
 
make_blobs


10 
äom
 
	gskË¬n
.
şu¡”
 
impÜt
 
KM—ns


12 
	g§m¶”
 = 
dimod
.
	$ExaùSŞv”
()

13 #5 
unknowns
, 
x0
 - 
x5


14 #
#(2 - 
x0
 
x1
 
x2
)^2

19 
Ex·nded


22 -4 
x0
 
x1
 
x2


23 +
x0
^2 
x1
^2 
x2
^2

25 
SŞutiÚ
 
should
 
be
: 
x0
: 1, 
x1
: 1, 
x2
: 1

30 #lš—¸
cÛffic›Ás


32 
q1
 = {
	}
}

33 
q1
['x0','x0'] = 1

34 
q1
['x1','x1'] = 1

35 
q1
['x2','x2'] = 1

37 
q1
['x0','x1'] = -4+1

38 
q1
['x1','x2'] = -4+1

40 #q1['x0','x1x2'] = -4+1 #»suÉ 
is
 {'x0': 1, 'x1': 0, 'x1x2': 1, 'x2': 0}

41 #q1['x0x1','x2'] = -4+1 #ResuÉ 
is
: {'x0': 0, 'x0x1': 1, 'x1': 0, 'x2': 1}

44 
	g§m¶e£t1
 = 
§m¶”
.
	$§m¶e_qubo
(
q1
)

46 
	$´št
(
§m¶e£t1
)

48 
	`´št
("ResuÉ is: ", 
§m¶e£t1
.
fœ¡
.
§m¶e
)

	@quadratic_automated.py

1 
impÜt
 
numpy
 
as
 
Å


2 
impÜt
 
cİy


3 
impÜt
 
dimod


4 
impÜt
 
¿ndom


5 
impÜt
 
m©h


6 
äom
 
m©h
 
impÜt
 
log


7 
impÜt
 
	gdimod


9 #CÚv”t 
a
 ||
Ax
-
b
|| 
´obËm
 
što
‡ 
QUBO


10 
def
 
	$qubo_´•
(
A
,
b
,
n
,
b™¥ow”
,
v¬Çmes
=
NÚe
):

12 #'
A
' ishe matrix which is‡‚p.array(),‡ matrix which is m x‚

13 #b 
is
 
the
 
veùÜ
 
š
h
ex´essiÚ
 : 
Ax
-
b
, 
ª
 
Å
.
	`¬¿y
(è
of
 
Ëngth
 
m


14 #À
is
 
ª
 
š‹g”
 
v®ue
 
th©
 i 
the
 
Ëngth
 
of
h
cŞumn
 
veùÜ
 
x


15 #b™¥ow” 
is
 
a
 
li¡
 
of
 
pow”s
 
th©
 
would
 
be
 
­¶›d
 
š
‡ 2
s
 
com¶em’t
 
way
,

16 #eg : [2,1,0] 
would
 
be
 
­¶›d
 
w™h
 
ªÙh”
 
b™
 
cked
 
Ú
 
äÚt
 
as
 : -2^(
	`Ën
(
b™¥ow”
) + 2^(2) + 2^(1) + 2^(0)

17 #v¬Çme 
´ovided
 
is
 
a
 
li¡
 
of
 
v¬ŸbË
 
Çme
. 
eg
 : 
v¬Çmes
 = [
x1
,
x2
,
x3
]

18 #NÙ: 
the
 
im¶em’tiÚ
 
»quœes
h
li¡
 
to
 
be
 
a
 
£t
 
of
 
deü—sšg
 
ªd
 
cÚ£cutive
 
numb”s
, 
sÜry
!

20 #A 
diùiÚ¬y
 
Qdiù
 
which
 
is
 
the
 
QUBO
 
this
 
´obËm


21 #A 
diùiÚ¬y
 
Qdiù_®t
 
which
 
the
 
§me
 
QUBO
 
but
 
w™h
 
®phªum”ic
 
	`v¬ŸbË
 (
keys
è
Çmes


22 
n_i_ùr
 = 0

23 
i_pow”ùr
 = 0

24 
i_twosymb
 = 0

26 
¡r_b™¥ow”
 = ['nuÎ'] + [
	$¡r
(
™em
è™em 
š
 
b™¥ow”
]

27 
pow”soáwo
 = 
Å
.
	`z”os
(
	`Ën
(
b™¥ow”
)+1)

29 
i
 
š
 
	`¿nge
(0,
	`Ën
(
b™¥ow”
)+1):

30 
i
==0:

31 
pow”soáwo
[
i
] = (2**(
b™¥ow”
[i]+1))*(-1)

33 
pow”soáwo
[
i
] = 2**(
b™¥ow”
[i-1])

34 
Qš™
 = 
Å
.
	$z”os
([
n
,n]è#A 
´Ùo
-
QUBO
 
th©
 
´•roûs£s
 
some
 
v®ues
 
the
 
aùu®
 QUBO. 
In™Ÿl
 QUBO 
you
 
wl


35 
Qdiù
 = {
	}
} #A 
diùiÚ¬y
 
th©
 
¡Ües
 
the
 
fš®
 
QUBO


37 
Qdiù_®t
 = {} #Thi 
diùiÚ¬y
 
§ves
 
the
 
®‹º©e
 
QUBO
 
w™h
 
®phªum”ic
 
	$v¬ŸbË
 (
keys
è
Çmes


38 
šdex_diù
 = {
	}
} #DiùiÚ¬y 
th©
 
m­s
 
®phªum”ic
 
v¬ŸbËs
 
to
 
the
 
š‹g”
 
Úes


40 
i
 
š
 
	$¿nge
(0,
n
):

41 
j
 
š
 
	$¿nge
(
i
,
n
):

42 
Qš™
[
i
,
j
] = 2*
	$sum
(
A
[:,
i
]*A[:,
j
])

43 
bÃw
 = 2*
b


46 
i
 
š
 
	`¿nge
(0,
n
*
	$Ën
(
pow”soáwo
)):

47 
i
%
	`Ën
(
pow”soáwo
)==0 
ªd
 i>0:

48 
n_i_ùr
 =‚_i_ctr + 1

49 
i_pow”ùr
=0

50 
n_j_ùr
 = 
n_i_ùr


51 
j_pow”ùr
 = 
i_pow”ùr


52 
j
 
š
 
	`¿nge
(
i
,
n
*
	$Ën
(
pow”soáwo
)):

53 
i
==
j
:#Lš—¸
cÛffic›Á


54 
Qdiù
[
i
,i] = (
pow”soáwo
[
i_pow”ùr
]**2)*(
	`sum
(
A
[:,
n_i_ùr
]**2)è-…ow”soáwo[i_pow”ùr]*
	$sum
(
A
[:,
n_i_ùr
]*
bÃw
)

55 
v¬Çmes
 !ğ
NÚe
:

56 
‹mpv¬1
 = 
v¬Çmes
[
n_i_ùr
] + '_' + 
¡r_b™¥ow”
[
i_pow”ùr
]

57 
šdex_diù
[
‹mpv¬1
] = 
i


58 
Qdiù_®t
[
‹mpv¬1
,‹mpv¬1] = 
Qdiù
[
i
,i]

59 :#Quad¿tiø
cÛffic›Á


60 
j
%
	`Ën
(
pow”soáwo
)==0 
ªd
 j>0:

61 
n_j_ùr
 =‚_j_ctr + 1

62 
j_pow”ùr
 = 0

63 
Qdiù
[
i
,
j
] = 
pow”soáwo
[
i_pow”ùr
]*pow”soáwo[
j_pow”ùr
]*
Qš™
[
n_i_ùr
,
n_j_ùr
]

64 
v¬Çmes
 !ğ
NÚe
:

65 
‹mpv¬2
 = 
v¬Çmes
[
n_j_ùr
] + '_' + 
¡r_b™¥ow”
[
j_pow”ùr
]

66 
Qdiù_®t
[
‹mpv¬1
,
‹mpv¬2
] = 
Qdiù
[
i
,
j
]

68 
j_pow”ùr
 = j_powerctr + 1

69 
i_pow”ùr
 = i_powerctr + 1

71 
v¬Çmes
 !ğ
NÚe
:

72  
Qdiù
, 
Qdiù_®t
, 
šdex_diù


74  
Qdiù
 #ju¡  
the
 
b¬e
 
bÚes
 
v¬Çmes
 
nÙ
 
»que¡ed


76 #Thi 
is
 
ju¡
 
to
 
cÚv”t
 
a
 
diùiÚ¬y
 
ba£d
 
»suÉ
 
što
‡ 
bš¬y
 
¡ršg
 based„esult

77 
def
 
	$g‘_bš_¡r
(
cÚfig
,
isisšg
=
True
):

79 #cÚfig 
is
 
a
 
diùiÚ¬y


80 #isisšg 
is
 
True
 
cÚfig
 
has
 -1 
Ü
 +1 
ªd
 
F®£
 config has 0 or 1

82 #¨
bš¬y
 
¡ršg
 
of
 0
s
 
ªd
 1s

83 
bš¡r
 = ""

84 
isisšg
 =ğ
True
:

85 
i
 
š
 
	`¿nge
(0,
	$Ën
(
cÚfig
)):

86 
cÚfig
[
i
] == 1:

87 
bš¡r
 +ğ
	$¡r
(1)

88 
–if
 
cÚfig
[
i
] == -1:

89 
bš¡r
 +ğ
	$¡r
(0)

91 
i
 
š
 
	`¿nge
(0,
	$Ën
(
cÚfig
)):

92 
cÚfig
[
i
] == 1:

93 
bš¡r
 +ğ
	$¡r
(1)

94 
–if
 
cÚfig
[
i
] == 0:

95 
bš¡r
 +ğ
	$¡r
(0)

96  
bš¡r


98 #´oûs£ 
the
 
bš¬y
 
¡ršg
 
što
 
a
 
Å
.
¬¿y
 
veùÜ
.

99 
def
 
	$qubo_to_»®
(
bš¡r
,
n
,
´ec_li¡
):

100 #´•¬
the
 
pow”s_of_two
 
li¡


102 
pow”s_of_two
 = []

103 
pow”s_of_two
.
	`­³nd
(-2**(
´ec_li¡
[0]+1))

106 
i
 
š
 
	`¿nge
(0,
	$Ën
(
´ec_li¡
)):

107 
pow”s_of_two
.
	`­³nd
(2**(
´ec_li¡
[
i
]))

108 #Now 
the
 
aùu®
 
numb”


109 
bš_ùr
=0

110 
cur_»®
 = 
Å
.
	$z”os
(
n
)

111 
i
 
š
 
	$¿nge
(0,
n
):

112 
j
 
š
 
	`¿nge
(0,
	$Ën
(
pow”s_of_two
)):

113 
cur_»®
[
i
] +ğ
pow”s_of_two
[
j
]*(
bš¡r
[
bš_ùr
])

114 
bš_ùr
 += 1

116  
cur_»®


118 
def
 
	$qubo_´•_nÚÃg
(
A
,
b
,
n
,
b™¥ow”
, 
v¬Çmes
=
NÚe
):

119 #Sam
as
 
qubo_´•
 
but
 
Úly
 
nÚ
-
Ãg©ive
 
v®ues


120 #b™¥ow” = [0] 
bš¬y
 
v®ues


123 
n_i_ùr
 = 0

124 
i_pow”ùr
 = 0

125 
i_twosymb
 = 0

127 
¡r_b™¥ow”
 =[
	$¡r
(
™em
è™em 
š
 
b™¥ow”
]

128 
pow”soáwo
 = 
Å
.
	`z”os
(
	$Ën
(
b™¥ow”
))

130 
i
 
š
 
	`¿nge
(0,
	$Ën
(
b™¥ow”
)):

131 
pow”soáwo
[
i
] = 2**(
b™¥ow”
[i])

133 
Qš™
 = 
Å
.
	$z”os
([
n
,n])

134 
Qdiù
 = {
	}
} #Th
diùiÚ¬y
 
our
 
qubo


136 
Qdiù_®t
 = {} #Thi 
diùiÚ¬y
 
§ves
 
the
 
®‹º©e
 
QUBO
 
w™h
 
®phªum”ic
 
	$v¬ŸbË
 (
keys
è
Çmes


137 
šdex_diù
 = {
	}
} #DiùiÚ¬y 
th©
 
m­s
 
®phªum”ic
 
v¬ŸbËs
 
to
 
the
 
š‹g”
 
Úes


139 
i
 
š
 
	$¿nge
(0,
n
):

140 
j
 
š
 
	$¿nge
(
i
,
n
):

141 
Qš™
[
i
,
j
] = 2*
	$sum
(
A
[:,
i
]*A[:,
j
])

142 
bÃw
 = 2*
b


144 
i
 
š
 
	`¿nge
(0,
n
*
	$Ën
(
pow”soáwo
)):

145 
i
%
	`Ën
(
pow”soáwo
)==0 
ªd
 i>0:

146 
n_i_ùr
 =‚_i_ctr + 1

147 
i_pow”ùr
=0

148 
n_j_ùr
 = 
n_i_ùr


149 
j_pow”ùr
 = 
i_pow”ùr


150 
j
 
š
 
	`¿nge
(
i
,
n
*
	$Ën
(
pow”soáwo
)):

151 
i
==
j
: #Lš—¸
cÛffic›Á


152 
Qdiù
[
i
,i] = (
pow”soáwo
[
i_pow”ùr
]**2)*(
	`sum
(
A
[:,
n_i_ùr
]**2)è-…ow”soáwo[i_pow”ùr]*
	$sum
(
A
[:,
n_i_ùr
]*
bÃw
)

153 
v¬Çmes
 !ğ
NÚe
:

154 
‹mpv¬1
 = 
v¬Çmes
[
n_i_ùr
] + '_' + 
¡r_b™¥ow”
[
i_pow”ùr
]

155 
šdex_diù
[
‹mpv¬1
] = 
i


156 
Qdiù_®t
[
‹mpv¬1
,‹mpv¬1] = 
Qdiù
[
i
,i]

157 : #Quad¿tiø
cÛffic›Á


158 
j
%
	`Ën
(
pow”soáwo
)==0 
ªd
 j>0:

159 
n_j_ùr
 =‚_j_ctr + 1

160 
j_pow”ùr
 = 0

161 
Qdiù
[
i
,
j
] = 
pow”soáwo
[
i_pow”ùr
]*pow”soáwo[
j_pow”ùr
]*
Qš™
[
n_i_ùr
,
n_j_ùr
]

162 
v¬Çmes
 !ğ
NÚe
:

163 
‹mpv¬2
 = 
v¬Çmes
[
n_j_ùr
] + '_' + 
¡r_b™¥ow”
[
j_pow”ùr
]

164 
Qdiù_®t
[
‹mpv¬1
,
‹mpv¬2
] = 
Qdiù
[
i
,
j
]

166 
j_pow”ùr
 = j_powerctr + 1

167 
i_pow”ùr
 = i_powerctr + 1

169 
v¬Çmes
 !ğ
NÚe
:

170  
Qdiù
, 
Qdiù_®t
, 
šdex_diù


172  
Qdiù
 #ju¡  
the
 
b¬e
 
bÚes
 
v¬Çmes
 
nÙ
 
»que¡ed


174 #FunùiÚ 
to
 
cÚv”t
 
the
 
sŞutiÚ
 
diùiÚ¬y
 
äom
 
®phªum”ic
 
v¬ŸbËs
Ø
š‹g”


175 
def
 
	$cÚv”t_»suÉ
(
sŞn_diù
,
šdex
):

176 
Ãw_diù
 = {
	}
}

177 
key
,
v®ue
 
š
 
	gsŞn_diù
.
	$™ems
():

178 
Ãw_diù
[
šdex
[
key
]] = 
v®ue


179  
Ãw_diù


182 #(6 - 
x1
 - 
x2
)^2

183 #InÜd” 
to
 
»pu½o£
 
a
 
code
 ||
Ax
 - 
b
|| 
šdividu®
 
quad¿tic
 
equ©iÚs
 
n
 
v¬ŸbËs
,
THe
 
Dim’siÚs
 
A
 
is
 1 
x
‚, x :‚ x 1 
ªd
 b : 1 x 1

184 
A
 = 
Å
.
	$¬¿y
([[1,1]])

185 
´ec_li¡
 = [1,0]

186 
b
 = 
Å
.
	$¬¿y
([6])

187 
n
=2

188 
v¬Çmes
 = ['x1','x2']

189 
Q
,
Q_®t
,
šdex
 = 
	$qubo_´•
(
A
,
b
,
n
,
´ec_li¡
,
v¬Çmes
=varnames)

192 
§m¶”
 = 
dimod
.
	$ExaùSŞv”
()

193 
§m¶e£t
 = 
§m¶”
.
	$§m¶e_qubo
(
Q_®t
)

194 
	$´št
(
§m¶e£t
.
fœ¡
.
§m¶e
)

197 #G‘ 
the
 
sŞutiÚ


198 
sŞn_diù
 = 
	$cÚv”t_»suÉ
(
§m¶e£t
.
fœ¡
.
§m¶e
,
šdex
)

199 #cÚv”ˆ
diù
 
to
 
¡ršg


200 
sŞn_bš
ğ
	$g‘_bš_¡r
(
sŞn_diù
,
isisšg
=
F®£
)

201 #cÚv”ˆ
¡ršg
 
to
 
Å
.
¬¿y
 
x


202 
x
 = 
	$qubo_to_»®
(
sŞn_bš
,
n
,
´ec_li¡
)

203 
	$´št
(
x
)

205 
Q
 = 
	$qubo_´•
(
A
,
b
,
n
,
´ec_li¡
)

206 
§m¶”
 = 
dimod
.
	$ExaùSŞv”
()

207 
§m¶e£t
 = 
§m¶”
.
	$§m¶e_qubo
(
Q
)

208 
	$´št
(
§m¶e£t
.
fœ¡
.
§m¶e
)

211 #G‘ 
the
 
sŞutiÚ


212 
sŞn_diù
 = 
§m¶e£t
.
fœ¡
.
§m¶e


213 #cÚv”ˆ
diù
 
to
 
¡ršg


214 
sŞn_bš
ğ
	$g‘_bš_¡r
(
sŞn_diù
,
isisšg
=
F®£
)

215 #cÚv”ˆ
¡ršg
 
to
 
Å
.
¬¿y
 
x


216 
x
 = 
	$qubo_to_»®
(
sŞn_bš
,
n
,
´ec_li¡
)

217 
	$´št
(
x
)

219 #(2 - 
x1
 - 
x2
 - 
x3
)^2 = (x1 + x2 + x3-2)^2 :

220 #wh”
x
 
is
 
bš¬y


221 
A
 = 
Å
.
	$¬¿y
([[1,1,1]])

222 
´ec_li¡
 = [0]

223 
b
 = 
Å
.
	$¬¿y
([2])

224 
v¬Çmes
 = ['x1','x2','x3']

225 
n
=3

227 
Q
,
Q_®t
,
šdex
 = 
	$qubo_´•_nÚÃg
(
A
,
b
,
n
,
´ec_li¡
,
v¬Çmes
=varnames)

229 
	`´št
(
Q_®t
)

	@quantum-centers.py

1 
impÜt
 
	gm©¶Ùlib
.
py¶Ù
 
as
 
¶t


2 
impÜt
 
numpy
 
as
 
Å


3 
äom
 
	gskË¬n
.
d©a£ts
 
impÜt
 
make_blobs


4 
impÜt
 
dimod


5 
äom
 
	gdwave
.
	gsy¡em
.
compos™es
 
impÜt
 
EmbeddšgCompos™e


6 
äom
 
	gdwave
.
	gsy¡em
.
§m¶”s
 
impÜt
 
DWaveSam¶”


7 
impÜt
 
Ã®


10 
	$´št
(
__doc__
)

13 #G’”©
§m¶e
 
d©a


14 
X
, 
Ïb–s_Œue
 = 
	$make_blobs
(

15 
n_§m¶es
=10, 
şu¡”_¡d
=0.5, 
¿ndom_¡©e
=0

19 
a
 = 10

20 
b
 = 20

21 
c
 = 30

23 
h
 = {
	}
}

24 
J
 = {(
a
,
b
): 0.5, (a,
c
): 0.01, (b,c): 0.25}

26 
exaù_§m¶”
 = 
dimod
.
	$ExaùSŞv”
()

27 
bqm
 = 
dimod
.
Bš¬yQuad¿ticMod–
.
	$äom_isšg
(
h
,
J
)

29 
»¥Ú£
 = 
exaù_§m¶”
.
	$§m¶e
(
bqm
)

30 
	`´št
(
»¥Ú£
)

	@qubo.py

1 
impÜt
 
numpy
 
as
 
Å


2 
impÜt
 
cİy


3 
impÜt
 
dimod


4 
impÜt
 
¿ndom


5 
impÜt
 
m©h


6 
äom
 
m©h
 
impÜt
 
log


7 
impÜt
 
dimod


8 
impÜt
 
µršt


9 
impÜt
 
Ã®


10 
impÜt
 
	gnumpy
.
lš®g
 
as
 
LA


11 
impÜt
 
	gm©¶Ùlib
.
py¶Ù
 
as
 
¶t


12 
impÜt
 
numpy
 
as
 
Å


13 
äom
 
	gskË¬n
.
d©a£ts
 
impÜt
 
make_blobs


14 
äom
 
	gskË¬n
.
şu¡”
 
impÜt
 
KM—ns


15 
äom
 
d©‘ime
 
impÜt
 
	gd©‘ime


18 #v = 
our
 
V
 
m©rix
 
which
 
is
 
p
 
x
 
n
 matrix

19 #w = 
our
 
W
 
m©rix
 
which
 
is
 
p
 
x
 
k


20 #h = 
our
 
H
 
m©rix
 
which
 
is
 
k
 
x
 
n


21 #k = #oà
şu¡”s


24 
V
 
W
 
	gH


25 [
v11
, 
v12
] [
w11
, 
w12
] [
h11
, 
h12
]

26 [
v21
, 
v22
] [
w21
, 
w22
] [
h21
, 
h22
]

28 (
	gv11
 - (
w11
 * 
	gh11
è+ (
w12
 * 
	gh21
) )^2 +

29 (
	gv12
 - (
w11
 * 
	gh12
è+ (
w12
 * 
	gh22
) )^2 +

30 (
	gv21
 - (
w21
 * 
	gh11
è+ (
w22
 * 
	gh21
) )^2 +

31 (
	gv22
 - (
w21
 * 
	gh12
è+ (
w22
 * 
	gh22
) )^2

34 #AÂ—Ë¸
wl
  
bš¬y
 
v®ue
, 
Ãed
 
to
 
cÚv”t
 
back
Ø
»®s


35 #usšg 
­´oxim©iÚ


36 #CÚv”ˆ
»®
 
v®ue
 
by
 
kšg
 
æoÜ
 
of
 v®u
th’
 
make
 
bš¬y


37 
def
 
	$­´ox_»®
(
r
):

38  
	`bš
(
m©h
.
	`æoÜ
(
r
).
	`¥l™
('0b')[1])

40 
def
 
	$bš_to_»®
(
bš¡r
):

41  (
bš¡r
,2)

43 #Figu» 
out
 
®l
 
v_ij
 - 
sum_h
 
w_ih
 * 
h_hj


44 #·s 
š
 
k
 , #oà
şu¡”s


46 
def
 
	$fšd_v¬s
(
v
,
k
):

48 
v_li¡
 = 
	$li¡
()

50 #StÜ
our
 
wh
 
v®ues
 
ªd
 
š
 
»v”£


51 
x_diù
 = {
	}
}

52 
x_diù_»v
 = {}

54 #¡Ü
our
 
v
 
v®ues


55 #Thi 
wl
 
es£ÁŸÎy
 
be
 
a
 
£t
 
of
 
Ã¡ed
 
diùiÚ¬›s


57 (
x
, 
	gy
) : {

58 
v_v®
: { 
v
} ,

59 
	gwh
: { (
wh_ik
, 
	gwh_kj
) }

63 #Diù 
our
 
V
 
pos™iÚ
 
ªd
 
v®ues
 
š
 V

64 
	gv_diù
 = {}

66 #
_diù = {}

69 #G‘ 
cÜ»ù
 
dim’siÚs


70 #V 
is
 
p
 
x
 
n


71 
p
 = 
v
.
sh­e
[0]

72 
n
 = 
v
.
sh­e
[1]

74 #W 
is
 
p
 
x
 
k


75 
w_rows
 = 
p


76 
w_cŞs
 = 
k


78 #H 
is
 
k
 
x
 
n


79 
h_rows
 = 
k


80 
h_cŞs
 = 
n


83 #G‘ 
the
 
V
's

84 #V 
is
 
p
 
x
 
n


85 
i
 
š
 
	$¿nge
(0,
p
):

86 
j
 
š
 
	$¿nge
(0, 
n
):

87 #¡ršgify 
wh©
 
is
 
š
 
V
 
©
 
this
 
loÿtiÚ


88 
i_idx
 = 
i
+1

89 
j_idx
 = 
j
+1

90 
v_diù
[
i_idx
,
j_idx
] = {
	}
}

91 
v_diù
[
i_idx
,
j_idx
]['v_v®'] = 
	$¡r
(
v
[
i
][
j
])

92 
v_diù
[
i_idx
,
j_idx
]['wh'] = []

93 #v_¡¸ğ
	`¡r
(
v
[
i
][
j
]) + "-"

94 #v_li¡.
	`­³nd
(
v_¡r
)

96 #Bud 
WH


97 #WH 
wl
 
be
 
§me
 
as
 
V
 , 
so
 
p
 
x
 
n


98 
wh_út
 = 1

99 
i
 
š
 
	$¿nge
(0,
w_rows
):

100 
j
 
š
 
	$¿nge
(0,
h_cŞs
):

101 #Thi 
is
 
ju¡
 
šdexšg
 
to
 
make
 
™
 
m©ch
 
ªd
 
nÙ
 
šdex
 
äom
 0

102 
i_idx
 = 
i
+1

103 
j_idx
 = 
j
+1

104 
l
 
š
 
	$¿nge
(0,
w_cŞs
): #Thi 
is
 
the
 
cŞumn
 
veùÜ
 
£ËùiÚ


105 #´št("w" + 
	`¡r
(
i
+1è+ sŒ(
l
+1è+ "h" + sŒÖ+1è+ sŒ(
j
+1))

106 #x_diù['x'+
	`¡r
(
wh_út
)] = ("w" + sŒ(
i
+1è+ sŒ(
l
+1è+ "h" + sŒÖ+1è+ sŒ(
j
+1))

107 
x_diù
['x'+
	`¡r
(
wh_út
)] = ("w" + sŒ(
i
+1è+ sŒ(
l
+1), "h" + sŒÖ+1è+ sŒ(
j
+1))

108 
x_diù_»v
[("w" + 
	`¡r
(
i
+1è+ sŒ(
l
+1), "h" + sŒÖ+1è+ sŒ(
j
+1))] = 'x'+
	$¡r
(
wh_út
)

109 
v_diù
[
i_idx
,
j_idx
]['wh'].
	`­³nd
Ğ("w"+
	`¡r
(
i
+1è+ sŒ(
l
+1), "h"+¡rÖ+1)+¡r(
j
+1)) )

110 
wh_út
 += 1

111 #x_diù['x'+
	`¡r
(
i
)] = "w" + sŒ(i+1è+ sŒ(
l
+1è+ "h" + sŒÖ+1è+ sŒ(
j
+1)

114 
k
,
v
 
š
 
x_diù
.
	$™ems
():

115 
	`´št
(
k
,":", 
v
)

117 
k
,
v
 
š
 
x_diù_»v
.
	$™ems
():

118 
	`´št
(
k
,":", 
v
)

120 
k
,
v
 
š
 
v_diù
.
	$™ems
():

121 
	`´št
(
k
,":",
v
)

123  
v_diù
, 
x_diù
, 
x_diù_»v
, 
p
, 
n


126 #Ax-
b
 
is
 
sim¬
 
to
 
V
-
WH


127 #V = 
b
 
h”e


128 #W = 
A


129 #H = 
x
 ??

130 ## 
Code
 
äom
 
Ajškya
 
BÜË
 
š
 
nick_quad¿tic_autom©ed


132 #CÚv”t 
a
 ||
Ax
-
b
|| 
´obËm
 
što
‡ 
QUBO


133 
def
 
	$qubo_´•
(
A
,
b
,
n
,
b™¥ow”
,
v¬Çmes
=
NÚe
):

135 #'
A
' ishe matrix which is‡‚p.array(),‡ matrix which is m x‚

136 #b 
is
 
the
 
veùÜ
 
š
h
ex´essiÚ
 : 
Ax
-
b
, 
ª
 
Å
.
	`¬¿y
(è
of
 
Ëngth
 
m


137 #À
is
 
ª
 
š‹g”
 
v®ue
 
th©
 i 
the
 
Ëngth
 
of
h
cŞumn
 
veùÜ
 
x


138 #b™¥ow” 
is
 
a
 
li¡
 
of
 
pow”s
 
th©
 
would
 
be
 
­¶›d
 
š
‡ 2
s
 
com¶em’t
 
way
,

139 #eg : [2,1,0] 
would
 
be
 
­¶›d
 
w™h
 
ªÙh”
 
b™
 
cked
 
Ú
 
äÚt
 
as
 : -2^(
	`Ën
(
b™¥ow”
) + 2^(2) + 2^(1) + 2^(0)

140 #v¬Çme 
´ovided
 
is
 
a
 
li¡
 
of
 
v¬ŸbË
 
Çme
. 
eg
 : 
v¬Çmes
 = [
x1
,
x2
,
x3
]

141 #NÙ: 
the
 
im¶em’tiÚ
 
»quœes
h
li¡
 
to
 
be
 
a
 
£t
 
of
 
deü—sšg
 
ªd
 
cÚ£cutive
 
numb”s
, 
sÜry
!

143 #A 
diùiÚ¬y
 
Qdiù
 
which
 
is
 
the
 
QUBO
 
this
 
´obËm


144 #A 
diùiÚ¬y
 
Qdiù_®t
 
which
 
the
 
§me
 
QUBO
 
but
 
w™h
 
®phªum”ic
 
	`v¬ŸbË
 (
keys
è
Çmes


145 
n_i_ùr
 = 0

146 
i_pow”ùr
 = 0

147 
i_twosymb
 = 0

149 
¡r_b™¥ow”
 = ['nuÎ'] + [
	$¡r
(
™em
è™em 
š
 
b™¥ow”
]

150 
pow”soáwo
 = 
Å
.
	`z”os
(
	`Ën
(
b™¥ow”
)+1)

152 
i
 
š
 
	`¿nge
(0,
	`Ën
(
b™¥ow”
)+1):

153 
i
==0:

154 
pow”soáwo
[
i
] = (2**(
b™¥ow”
[i]+1))*(-1)

156 
pow”soáwo
[
i
] = 2**(
b™¥ow”
[i-1])

157 
Qš™
 = 
Å
.
	$z”os
([
n
,n]è#A 
´Ùo
-
QUBO
 
th©
 
´•roûs£s
 
some
 
v®ues
 
the
 
aùu®
 QUBO. 
In™Ÿl
 QUBO 
you
 
wl


158 
Qdiù
 = {
	}
} #A 
diùiÚ¬y
 
th©
 
¡Ües
 
the
 
fš®
 
QUBO


160 
Qdiù_®t
 = {} #Thi 
diùiÚ¬y
 
§ves
 
the
 
®‹º©e
 
QUBO
 
w™h
 
®phªum”ic
 
	$v¬ŸbË
 (
keys
è
Çmes


161 
šdex_diù
 = {
	}
} #DiùiÚ¬y 
th©
 
m­s
 
®phªum”ic
 
v¬ŸbËs
 
to
 
the
 
š‹g”
 
Úes


163 
i
 
š
 
	$¿nge
(0,
n
):

164 
j
 
š
 
	$¿nge
(
i
,
n
):

165 
Qš™
[
i
,
j
] = 2*
	$sum
(
A
[:,
i
]*A[:,
j
])

166 
bÃw
 = 2*
b


169 
i
 
š
 
	`¿nge
(0,
n
*
	$Ën
(
pow”soáwo
)):

170 
i
%
	`Ën
(
pow”soáwo
)==0 
ªd
 i>0:

171 
n_i_ùr
 =‚_i_ctr + 1

172 
i_pow”ùr
=0

173 
n_j_ùr
 = 
n_i_ùr


174 
j_pow”ùr
 = 
i_pow”ùr


175 
j
 
š
 
	`¿nge
(
i
,
n
*
	$Ën
(
pow”soáwo
)):

176 
i
==
j
:#Lš—¸
cÛffic›Á


177 
Qdiù
[
i
,i] = (
pow”soáwo
[
i_pow”ùr
]**2)*(
	`sum
(
A
[:,
n_i_ùr
]**2)è-…ow”soáwo[i_pow”ùr]*
	$sum
(
A
[:,
n_i_ùr
]*
bÃw
)

178 
v¬Çmes
 !ğ
NÚe
:

179 
‹mpv¬1
 = 
v¬Çmes
[
n_i_ùr
] + '_' + 
¡r_b™¥ow”
[
i_pow”ùr
]

180 
šdex_diù
[
‹mpv¬1
] = 
i


181 
Qdiù_®t
[
‹mpv¬1
,‹mpv¬1] = 
Qdiù
[
i
,i]

182 :#Quad¿tiø
cÛffic›Á


183 
j
%
	`Ën
(
pow”soáwo
)==0 
ªd
 j>0:

184 
n_j_ùr
 =‚_j_ctr + 1

185 
j_pow”ùr
 = 0

186 
Qdiù
[
i
,
j
] = 
pow”soáwo
[
i_pow”ùr
]*pow”soáwo[
j_pow”ùr
]*
Qš™
[
n_i_ùr
,
n_j_ùr
]

187 
v¬Çmes
 !ğ
NÚe
:

188 
‹mpv¬2
 = 
v¬Çmes
[
n_j_ùr
] + '_' + 
¡r_b™¥ow”
[
j_pow”ùr
]

189 
Qdiù_®t
[
‹mpv¬1
,
‹mpv¬2
] = 
Qdiù
[
i
,
j
]

191 
j_pow”ùr
 = j_powerctr + 1

192 
i_pow”ùr
 = i_powerctr + 1

194 
v¬Çmes
 !ğ
NÚe
:

195  
Qdiù
, 
Qdiù_®t
, 
šdex_diù


197  
Qdiù
 #ju¡  
the
 
b¬e
 
bÚes
 
v¬Çmes
 
nÙ
 
»que¡ed


199 #Thi 
is
 
ju¡
 
to
 
cÚv”t
 
a
 
diùiÚ¬y
 
ba£d
 
»suÉ
 
što
‡ 
bš¬y
 
¡ršg
 based„esult

200 
def
 
	$g‘_bš_¡r
(
cÚfig
,
isisšg
=
True
):

202 #cÚfig 
is
 
a
 
diùiÚ¬y


203 #isisšg 
is
 
True
 
cÚfig
 
has
 -1 
Ü
 +1 
ªd
 
F®£
 config has 0 or 1

205 #¨
bš¬y
 
¡ršg
 
of
 0
s
 
ªd
 1s

206 
bš¡r
 = ""

207 
isisšg
 =ğ
True
:

208 
i
 
š
 
	`¿nge
(0,
	$Ën
(
cÚfig
)):

209 
cÚfig
[
i
] == 1:

210 
bš¡r
 +ğ
	$¡r
(1)

211 
–if
 
cÚfig
[
i
] == -1:

212 
bš¡r
 +ğ
	$¡r
(0)

214 
i
 
š
 
	`¿nge
(0,
	$Ën
(
cÚfig
)):

215 
cÚfig
[
i
] == 1:

216 
bš¡r
 +ğ
	$¡r
(1)

217 
–if
 
cÚfig
[
i
] == 0:

218 
bš¡r
 +ğ
	$¡r
(0)

219  
bš¡r


221 #´oûs£ 
the
 
bš¬y
 
¡ršg
 
što
 
a
 
Å
.
¬¿y
 
veùÜ
.

222 
def
 
	$qubo_to_»®
(
bš¡r
,
n
,
´ec_li¡
):

223 #´•¬
the
 
pow”s_of_two
 
li¡


225 
pow”s_of_two
 = []

226 
pow”s_of_two
.
	`­³nd
(-2**(
´ec_li¡
[0]+1))

229 
i
 
š
 
	`¿nge
(0,
	$Ën
(
´ec_li¡
)):

230 
pow”s_of_two
.
	`­³nd
(2**(
´ec_li¡
[
i
]))

231 #Now 
the
 
aùu®
 
numb”


232 
bš_ùr
=0

233 
cur_»®
 = 
Å
.
	$z”os
(
n
)

234 
i
 
š
 
	$¿nge
(0,
n
):

235 
j
 
š
 
	`¿nge
(0,
	$Ën
(
pow”s_of_two
)):

236 
cur_»®
[
i
] +ğ
pow”s_of_two
[
j
]*(
bš¡r
[
bš_ùr
])

237 
bš_ùr
 += 1

239  
cur_»®


241 
def
 
	$qubo_´•_nÚÃg
(
A
,
b
,
n
,
b™¥ow”
, 
v¬Çmes
=
NÚe
):

242 #Sam
as
 
qubo_´•
 
but
 
Úly
 
nÚ
-
Ãg©ive
 
v®ues


243 #b™¥ow” = [0] 
bš¬y
 
v®ues


246 
n_i_ùr
 = 0

247 
i_pow”ùr
 = 0

248 
i_twosymb
 = 0

250 
¡r_b™¥ow”
 =[
	$¡r
(
™em
è™em 
š
 
b™¥ow”
]

251 
pow”soáwo
 = 
Å
.
	`z”os
(
	$Ën
(
b™¥ow”
))

253 
i
 
š
 
	`¿nge
(0,
	$Ën
(
b™¥ow”
)):

254 
pow”soáwo
[
i
] = 2**(
b™¥ow”
[i])

256 
Qš™
 = 
Å
.
	$z”os
([
n
,n])

257 
Qdiù
 = {
	}
} #Th
diùiÚ¬y
 
our
 
qubo


259 
Qdiù_®t
 = {} #Thi 
diùiÚ¬y
 
§ves
 
the
 
®‹º©e
 
QUBO
 
w™h
 
®phªum”ic
 
	$v¬ŸbË
 (
keys
è
Çmes


260 
šdex_diù
 = {
	}
} #DiùiÚ¬y 
th©
 
m­s
 
®phªum”ic
 
v¬ŸbËs
 
to
 
the
 
š‹g”
 
Úes


262 
i
 
š
 
	$¿nge
(0,
n
):

263 
j
 
š
 
	$¿nge
(
i
,
n
):

264 
Qš™
[
i
,
j
] = 2*
	$sum
(
A
[:,
i
]*A[:,
j
])

265 #´št("qš™_i_j: ", 
Qš™
[
i
,
j
])

266 #´št("A_:,i",
i
,":", 
A
[:,i])

267 #´št("A_:,j",
j
,":", 
A
[:,j])

268 
bÃw
 = 2*
b


269 #´št("b: ", 
b
)

270 #´št("2*b:", 
bÃw
)

272 
i
 
š
 
	`¿nge
(0,
n
*
	$Ën
(
pow”soáwo
)):

273 
i
%
	`Ën
(
pow”soáwo
)==0 
ªd
 i>0:

274 
n_i_ùr
 =‚_i_ctr + 1

275 
i_pow”ùr
=0

276 
n_j_ùr
 = 
n_i_ùr


277 
j_pow”ùr
 = 
i_pow”ùr


278 
j
 
š
 
	`¿nge
(
i
,
n
*
	$Ën
(
pow”soáwo
)):

279 
i
==
j
: #Lš—¸
cÛffic›Á


280 
Qdiù
[
i
,i] = (
pow”soáwo
[
i_pow”ùr
]**2)*(
	`sum
(
A
[:,
n_i_ùr
]**2)è-…ow”soáwo[i_pow”ùr]*
	$sum
(
A
[:,
n_i_ùr
]*
bÃw
)

282 #´št("qdiù_i_i: ", 
Qdiù
[
i
,i])

283 
v¬Çmes
 !ğ
NÚe
:

284 
‹mpv¬1
 = 
v¬Çmes
[
n_i_ùr
] + '_' + 
¡r_b™¥ow”
[
i_pow”ùr
]

285 
šdex_diù
[
‹mpv¬1
] = 
i


286 
Qdiù_®t
[
‹mpv¬1
,‹mpv¬1] = 
Qdiù
[
i
,i]

287 : #Quad¿tiø
cÛffic›Á


288 
j
%
	`Ën
(
pow”soáwo
)==0 
ªd
 j>0:

289 
n_j_ùr
 =‚_j_ctr + 1

290 
j_pow”ùr
 = 0

291 
Qdiù
[
i
,
j
] = 
pow”soáwo
[
i_pow”ùr
]*pow”soáwo[
j_pow”ùr
]*
Qš™
[
n_i_ùr
,
n_j_ùr
]

292 #´št("qdiù_i_j:", 
Qdiù
[
i
,
j
])

293 
v¬Çmes
 !ğ
NÚe
:

294 
‹mpv¬2
 = 
v¬Çmes
[
n_j_ùr
] + '_' + 
¡r_b™¥ow”
[
j_pow”ùr
]

295 
Qdiù_®t
[
‹mpv¬1
,
‹mpv¬2
] = 
Qdiù
[
i
,
j
]

297 
j_pow”ùr
 = j_powerctr + 1

298 
i_pow”ùr
 = i_powerctr + 1

300 
v¬Çmes
 !ğ
NÚe
:

301  
Qdiù
, 
Qdiù_®t
, 
šdex_diù


303  
Qdiù
 #ju¡  
the
 
b¬e
 
bÚes
 
v¬Çmes
 
nÙ
 
»que¡ed


305 #FunùiÚ 
to
 
cÚv”t
 
the
 
sŞutiÚ
 
diùiÚ¬y
 
äom
 
®phªum”ic
 
v¬ŸbËs
Ø
š‹g”


306 
def
 
	$cÚv”t_»suÉ
(
sŞn_diù
,
šdex
):

307 
Ãw_diù
 = {
	}
}

308 
key
,
v®ue
 
š
 
	gsŞn_diù
.
	$™ems
():

309 
Ãw_diù
[
šdex
[
key
]] = 
v®ue


310  
Ãw_diù


312 
def
 
	$couÁ_Úes
(
H
):

314 
cŞ_num
 
š
 
	$¿nge
(0, 
H
.
sh­e
[1]):

315 
cŞ_couÁ
 = 0

316 
row_num
 
š
 
	$¿nge
(0, 
H
.
sh­e
[0]):

317 #´št("Row: ", 
row_num
, "CŞ: ", 
cŞ_num
)

318 
H
[
row_num
][
cŞ_num
] == 1:

319 
cŞ_couÁ
 += 1

321 
	`´št
("CŞ: ", 
cŞ_num
, "1couÁ: ", 
cŞ_couÁ
)

325 
p
 
x
 
n


326 2 
x
 3

328 
p
 
x
 
k


329 2 
x
 2

331 
k
 
x
 
n


332 2 
x
 3

334 [
v11
, 
v12
] [
w11
, 
w12
] [
h11
, 
h12
]

335 [
v21
, 
v22
] [
w21
, 
w22
] [
h21
, 
h22
]

337 (
v11
 - (
w11
 * 
h11
è+ (
w12
 * 
h21
) )^2 +

338 (
v12
 - (
w11
 * 
h12
è+ (
w12
 * 
h22
) )^2 +

339 (
v21
 - (
w21
 * 
h11
è+ (
w22
 * 
h21
) )^2 +

340 (
v22
 - (
w21
 * 
h12
è+ (
w22
 * 
h22
) )^2

343 2 
x
 3

345 
V
 
W
 
H


346 [1,2,3] [
w11
, 
w12
] [
h11
, 
h12
, 
h13
]

347 [4,5,6] [
w21
, 
w22
] [
h21
, 
h22
, 
h23
]

349 
w11h11
 + 
w12h21
, 
w11h12
 + 
w12h22
, 
w11h13
 + 
w12h23


350 
w21h11
 + 
w22h21
, 
w21h12
 + 
w22h22
, 
w21h13
 + 
w22h23


352 
V
 - 
WH


354 (1 - (
w11h11
 + 
w12h21
))^2 +

355 (2 - (
w11h12
 + 
w12h22
))^2 +

356 (3 - (
w11h13
 + 
w12h23
))^2 +

357 (4 - (
w21h11
 + 
w22h21
))^2 +

358 (5 - (
w21h12
 + 
w22h22
))^2 +

359 (6 - (
w21h13
 + 
w22h23
))^2

362 3 
x
 3

364 
	$V
 (3x3è
	$W
 (3 
x
 2è
	`H
(2 x 3)

366 [1,2,3] [
w11
, 
w12
] [
h11
, 
h12
, 
h13
]

367 [4,5,6] [
w21
, 
w22
] [
h21
, 
h22
, 
h23
]

368 [7,8,9] [
w31
, 
w32
]

370 
w11h11
 + 
w12h21
, 
w11h12
 + 
w12h22
, 
w11h13
 + 
w12h23


371 
w21h11
 + 
w22h21
, 
w21h12
 + 
w22h22
, 
w21h13
 + 
w22h23


372 
w31h11
 + 
w32h21
, 
w31h12
 + 
w32h22
, 
w31h13
 + 
w32h23


374 (1- (
w11h11
 + 
w12h21
))^2 +

375 (2- (
w11h12
 + 
w12h22
))^2 +

382 (9- (
w31h13
 + 
w32h23
))^2

387 #(6 - 
x1
 - 
x2
)^2

388 #InÜd” 
to
 
»pu½o£
 
a
 
code
 ||
Ax
 - 
b
|| 
šdividu®
 
quad¿tic
 
equ©iÚs
 
n
 
v¬ŸbËs
,
THe
 
Dim’siÚs
 
A
 
is
 1 
x
‚, x :‚ x 1 
ªd
 b : 1 x 1

389 #A = 
Å
.
	`¬¿y
([[1,1]])

391 #b = 
Å
.
	`¬¿y
([6])

394 ###Q,
Q_®t
,
šdex
 = 
	`qubo_´•
(
A
,
b
,
n
,
´ec_li¡
,
v¬Çmes
=varnames)

395 #§m¶” = 
dimod
.
	`ExaùSŞv”
()

396 #§m¶e£ˆğ
§m¶”
.
	`§m¶e_qubo
(
Q_®t
)

397 #´št(
§m¶e£t
.
fœ¡
.
§m¶e
)

400 #muÉly 
Ax


401 #Ax 
is
 
the
 
sum
 
of
 
w
 
times
 
h
 
v¬s


402 #wh 
–em’ts
 
¬e
 
sub¡™uded
 
by
 
x
 
v¬ŸbËs


403 #dØ
b
 - 
Ax
 
the
 
v®ues
)

404 #A 
is
 
a
 
m©rix


405 #row 
¬e
 
®l
 1's

406 #cŞumn 
¬e
 #oà
v¬ŸbËs


410 
V
 
W
 
H


411 [
v11
, 
v12
] [
w11
, 
w12
] [
h11
, 
h12
]

412 [
v21
, 
v22
] [
w21
, 
w22
] [
h21
, 
h22
]

414 (
v11
 - (
w11
 * 
h11
è+ (
w12
 * 
h21
è)^2 + #v11 - (
w11h11
è+ (
w12h21
)

415 (
v12
 - (
w11
 * 
h12
è+ (
w12
 * 
h22
è)^2 + #v12 - (
w11h12
è+ (
w12h22
)

416 (
v21
 - (
w21
 * 
h11
è+ (
w22
 * 
h21
è)^2 + #v21 - (
w21h11
è+ (
w22h21
)

417 (
v22
 - (
w21
 * 
h12
è+ (
w22
 * 
h22
è)^2 #v22 - (
w21h12
è+ (
w22h22
)

419 
	`w11h11
(
w11h11
 + 
w12h21
è+ 
	`w12h21
(w11h11 + w12h21)

421 
w11h11
^2 + 
w11h11w12h21
 + 
w12h21w11h11
 + 
w12h21
^2 = w11h11^2 + 2(
w11h11w12h12
) + w12h21^2

423 
	`w11h12
(
w11h12
 + 
w12h22
è+ 
	`w12h22
(w11h12 + w12h22èğw11h12^2 + 2(
w11h12w12h22
) + w12h22^2

425 
	`w21h11
(
w21h11
+
w22h21
è+ 
	`w22h21
(w21h11+w22h21èğw21h11^2 + 2(
w21h11w22h21
) + w22h21^2

427 
	`w21h12
(
w21h12
 + 
w22h22
è+ 
	`w22h22
(w21h12+w22h22èğw21h12^2 + 2(
w21h12w22h22
) + w22h22^2

431 (
v11
 - 
w11h11
^2 + 2(
w11h11w12h12
è+ 
w12h21
^2è+ (
v12
 - 
w11h12
^2 + 2(
w11h12w12h22
è+ 
w12h22
^2 ) +

432 (
v21
 - 
w21h11
^2 + 2(
w21h11w22h21
è+ 
w22h21
^2è+ (
v22
 - 
w21h12
^2 + 2(
w21h12w22h22
è+ 
w22h22
^2 )

435 (
v11
 - 
x1
^2 + 2(x1 * 
x2
è+ x2^2è+ (
v12
 - 
x3
^2 + 2(x3 * 
x4
è+ x4^2 ) + (
v21
 - 
x5
^2 + 2(x5 * 
x6
è+ x6^2 ) + (
v22
 - 
x7
^2 + 2(x7 * 
x8
) + x8^2)

438 (
a
+
b
)^2 = (a+b)(a+b) =‡^2 + b^2 + 2ab

440 
x1
 : ('w11', 'h11')

441 
x2
 : ('w12', 'h21')

442 
x3
 : ('w11', 'h12')

443 
x4
 : ('w12', 'h22')

444 
x5
 : ('w21', 'h11')

445 
x6
 : ('w22', 'h21')

446 
x7
 : ('w21', 'h12')

447 
x8
 : ('w22', 'h22')

454 
¡¬t_time
 = 
d©‘ime
.
	$now
()

455 #IÀ
a
 2x2 
s™u©iÚ
, 
we
 
basiÿÎay
 
have
 
to
 
£nd
 
Úe
 
quad¿tic
 
ex´essiÚ
 
©
‡ 
time


456 
Q
 = {
	}
}

457 
Q_®t
 = {}

458 
šdex
 = {}

459 
Q_tÙ®
 = {}

464 #V = 
Å
.
¬¿y
([[2.5,7.3],[3.5,2]]

466 #2 
x
 2 
‹¡s
, -4 
to
 +3

467 #v = 
Å
.
¬¿y
([[1,2], [3,4]]è#2
x2


468 #v = 
Å
.
¬¿y
([[-1,-3], [2,3]])

469 #v = 
Å
.
¬¿y
([[-4,-4], [-4,-4]])

470 #v = 
Å
.
¬¿y
([[-4,3], [-2,1]])

471 #v = 
Å
.
¬¿y
([[-1,-4], [2,-3]])

473 #2 
x
 3 
‹¡s
 , -4 
to
 +3

475 #v = 
Å
.
¬¿y
([ [3,2,2], [1,3,3] ])

477 #v = 
Å
.
¬¿y
([ [3,2,1], [1,3,2] ])

478 #v = 
Å
.
¬¿y
([ [-4,0,1], [-1,-2,3]])

481 #3 
x
 3 
‹¡s
, -4 
to
 +3

482 #v = 
Å
.
¬¿y
([ [1,-1,-2], [-4,3,2], [1,0,3] ])

485 #2 
x
 3

488 #3 
x
 3

490 #fÜ 
make
 
qubo
, 
V
 = 
B
 
as
 
our
 
šput


491 #P»ø
Li¡
 
wÚ
't‡lways be†ikehis,…rob‚eedo dynamically figure it out based

492 #Ú 
šputs
..

495 
´ec_li¡
 = [2,1,0] #-8 
to
 +7

496 
´ec_li¡_¡r
 = ['null', '2', '1', '0']

500 -- 
NÚ
 
Œª¥o£d
, 
we
 
ÿn
 
u£
 
Å
.
Œª¥o£
 
to
 
fix
 
this
 --

502 
V
 = 
p
 
x
 
n


503 
W
 = 
p
 
x
 
k


504 
H
 = 
k
 
x
 
n


506 
p
 = 10

507 
k
 = 2

508 
n
 = 2

511 
V
 = 10 
x
 2

512 
W
 = 10 
x
 2

513 
H
 = 2 
x
 2

517 #Old 
nÚ
 
Œª¥o£d
 
¡uff


518 #w_‹¡ = 
Å
.
¬¿y
([ [1,3], [-4,2], [3,2], [-3,0] ]è#°
x
 
k
 - 4 x 2

519 #h_‹¡ = 
Å
.
¬¿y
([ [0,1,0,1], [1,0,1,0] ]è#k 
x
 
n
 - 2 x 4

520 #wh_‹¡ = 
Å
.
m©mul
(
w_‹¡
,
h_‹¡
è#°
x
 
n
 - 2 x 4

521 #v_‹¡ = 
wh_‹¡


522 #v = 
v_‹¡


524 #Te¡ 
ûÁ”s
 : (2,2è
ªd
 (5,5)

526 
num_§m¶es
 = 40

527 
k
 = 3

529 
V
, 
y
 = 
	$make_blobs
(

530 
n_§m¶es
=
num_§m¶es
, 
n_ã©u»s
=2,

531 
ûÁ”s
=
k
, 
şu¡”_¡d
=0.5,

532 
shufæe
=
True
, 
¿ndom_¡©e
=0

536 #´št(
	`ty³
(
V
))

537 #´št(
V
.
sh­e
)

539 #´št(
V
)

542 
v_šput
 = 
Å
.
	$¬¿y
([

554 #´št(
	`ty³
(
v_šput
))

555 #´št(
v_šput
.
sh­e
)

556 #´št(
v_šput
)

558 #v_Œª¥o£ = 
Å
.
	`Œª¥o£
(
V
)

559 
v
 = 
Å
.
	$Œª¥o£
(
V
)

561 ## 
OÆy
 
u£
 
this
 
¡uff
 
äom
 
ML
 
wh”e
 
row
 
veùÜs
 
¬e
 
ã©u»s


562 #v = 
v_Œª¥o£


565 #v_row ğ
v
.
sh­e
[0]

566 #v_cŞ ğ
v
.
sh­e
[1]

569 
	`´št
("\nGetting vars...\n")

570 
v_diù
, 
x_diù
, 
x_diù_»v
, 
p
, 
n
 = 
	$fšd_v¬s
(
v
,
k
)

572 ###Te¡ 
Ca£s
 
wh”e
 
WH
 
is
 
known
, 
V
 i 
made
 
autom©iÿÎy


574 
FÜ
 
‹¡šg
, 
make
 
up
 
a
 
WH
 
ªd
 
g‘
‡ 
»suÉ
 
of
 
V
, 
th’
 
‹¡


575 
Make
 
su»
 
to
 
put
 
this
 
š
 
dis£¹©iÚ
 
as
 
‹¡


576 
V
 = 
p
 
x
 
n


577 
W
 = 
p
 
x
 
k


578 
H
 = 
k
 
x
 
n


579 
V
 = 2 
x
 2

580 
W
 = 2 
x
 2

581 
H
 = 2 
x
 2

587 #v_11 - 
x1
 - 
x2


588 #v_12 - 
x3
 - 
x4


589 #v_21 - 
x5
 - 
x6


590 #v_22 - 
x7
 - 
x8


592 #´št(
v_diù
[(1,1)['v_val'])

593 #´št(
v_diù
[(1,1)]['wh'])

594 #´št(
v_diù
[(1,1)]['wh'][0][0])

595 #´št(
x_diù_»v
)

597 #SØ
we
 
Ãed
 
to
 
go
 
through
 
ªd
 dØ
Úe
 
quad¿tic
 
©
 
a
 
time


598 #W
£nd
 
Úly
 
the
 
v¬Çmes
 
assocŸ‹d
 
w™h
h
v
 - 
wh


599 #w
loİ
 
through
 
ev”ythšg
 
š
 
v_diù


600 #W
g‘
 
®l
 
WH
's‡s indexeso x_dict_rev

601 #W
u£
 
this
 
to
 
g‘
 
our
 
x
 
v®ues
Ø
·ss
Ø
v¬Çmes


602 #Úû 
we
 
g‘
 
ev”ythšg
 w
th’
 
ÿÎ
 
make_qubo


603 #W
g‘
 
the
 
q_®t
  
ªd
 
add
 
™
 
to
 
q_tÙ®


604 #´št(
v_diù
[(1,1)]['wh'][1])

607 
	`´št
("Parsing V dictionary...\n")

608 #GØ
through
 
maš
 
diùiÚ¬y
 
to
 
g‘
 
d©a


609 
key
, 
v®
 
š
 
v_diù
.
	$™ems
():

610 #´št(
v_diù
[
key
]['wh'])

611 #GØ
through
 
šdividu®
 
li¡
 
of
 
tu¶es


612 
v¬Çmes
 = []

613 
™em
 
š
 
v_diù
[
key
]['wh']:

614 #G‘ 
our
 
cÜ»¥Údšg
 
x
 
v®ues
 
to
 
WH
 values

615 
v¬Çmes
.
	$­³nd
(
x_diù_»v
[
™em
])

616 #Bud 
a
 
row
 
veùÜ
 
of
 1's for A

617 #A = 
Å
.
	`z”os
([1,
k
])

619 #G‘ 
—ch
 
–em’t
 
of
 
V
 
qubo_´•


620 #´št(
v¬Çmes
)

621 #AlsØ
¡Üe
 
them
 
as
 
a
 
æßtšg
 
pošt
 
numb”
 
vs
‡ 
¡ršg


622 #fÜ 
v_key
, 
v_v®
 
š
 
v_diù
.
	`™ems
():

623 #Bud 
a
 
row
 
veùÜ
 
of
 1's for A

624 
A
 = 
Å
.
	$z”os
([1,
k
])

625 
A
 += 1

626 
b
 = (
v_diù
[
key
]['v_val'])

627 
Q
, 
Q_®t
, 
šdex
 = 
	$qubo_´•
(
A
,
b
,
k
,
´ec_li¡
,
v¬Çmes
=varnames)

628 #Puˆ
ev”ythšg
 
äom
 
—ch
 
Q_®t
 
diù
 
što
 
ma¡”
 
Q_tÙ®


629 
key
, 
v®
 
š
 
Q_®t
.
	$™ems
():

630 #Check 
key
 
is
 
®»ady
 
h”e
, 
so
 
add
 
to
 
™


631 
key
 
š
 
Q_tÙ®
:

632 
Q_tÙ®
[
key
] +ğ
v®


634 
Q_tÙ®
[
key
] = 
v®


637 #´št(
Q_tÙ®
)

638 #µršt.
	`µršt
(
Q_tÙ®
)

640 
	`´št
("Applying†inearization…enalties...\n")

642 #D– =ğ
Ïg¬agÃ
 
·¿m


643 
d–
 = 15

644 
x_key
, 
x_v®
 
š
 
x_diù
.
	$™ems
():

645 
‹mp_h
 = 
x_v®
[1]

646 #´št(
‹mp_h
)

647 
´ec
 
š
 
´ec_li¡_¡r
:

648 
‹mp_x
 = 
x_key
 + "_" + 
´ec


649 #´št(
‹¡
)

650 
‹mp_w
 = 
x_v®
[0] + "_" + 
´ec


651 #´št(
‹mp_w
)

652 
Q_tÙ®
[
‹mp_w
, 
‹mp_h
] = 2 * 
d–


653 
Q_tÙ®
[
‹mp_x
, 
‹mp_w
] = -4 * 
d–


654 
Q_tÙ®
[
‹mp_x
, 
‹mp_h
] = -4 * 
d–


655 
Q_tÙ®
[
‹mp_x
,emp_x] +ğ6 * 
d–


657 #µršt.
	`µršt
(
Q_tÙ®
)

658 
	`´št
("Linearization Penalties: \n")

659 
µršt
.
	$µršt
(
Q_tÙ®
)

664 ## 
N“d
 
to
 dØ
like
 
we
 
did
 
above
 
w™h
 
the
 
h
 
v¬ŸbËs
 
ªd
 
nÙ
 
£nd
 
them
 
š
 
®l
 
©
 
Úû


665 ## 
Make
 
as
 
Çy
 
Q_®t2
‡ 
th”e
 
¬e
 
cŞumns
 
š
 
H


666 ## 
Each
 
cŞumn
 
ÿÎ
 
qubo_´•_nÚÃg
 
w™h
 
the
 
cÜ»ù
 
v¬Çmes
 
to
 
th©
 column

669 #Q,
Q_®t
,
šdex
 = 
	`qubo_´•_nÚÃg
(
A
,
b
,
n
,
´ec_li¡
,
v¬Çmes
=varnames)

671 #fÜ 
q
 
š
 
	`¿nge
(0,
v_rows
):

672 #fÜ 
r
 
š
 
	`¿nge
(0,
v_cŞs
):

673 #´št(
v
[
q
][
r
])

674 #A = 
Å
.
	`z”os
([1,
k
])

675 #A +ğ1 #mak
m©rix
 
®l
 1's

676 #Q,
Q_®t
,
šdex
 = 
	`qubo_´•_nÚÃg
(
A
,
b
[
q
][
r
],
n
,
´ec_li¡
,
v¬Çmes
=varnames)

679 ## 
So
 
h”e
 
we
 
¬e
 
gošg
 
to
 
Œy
 
the
 
H
 
³ÇÉy
 
wh”e
 w
’su»
 H 
Úly
 
has
 1 
£ËùiÚ


680 #W
go
 
through
 
this
 
´oûss
 
H
 
Úly
 , 
th’
 
we
 
add
 
the
 
»suÉs
 
to
 
Q_TÙ®
 
diù


681 #À
wl
 
be
 
Ëngth
 
of
 
h
 
cŞum
, 
so
 
this
 
is
 
k


682 #A 
m©rix
 
wl
 
be
 
®l
 
A
 1's†ength of k

683 #C®È
qubo_nÚeg
 
n
 
times


684 #Thi 
is
 
»®ly
 
bad
 
ª®ysis
 
¥aû
 
wi£
, 
but
 
we
 
ÿn
 
­´oxim©e
, cª 
İtmize
 
somewh©


685 #x: 
p
 * 
k
 * 
n


686 #w: 
c
 * 
p
 * 
k
 
wh”e
 c = 
´ecisiÚ


687 #h: 
k
 * 
n


688 #(
²
 + 
ı
 + 
n
è, 
k
 
is
 
out
 
beÿu£
 
™
' ´e£Á iÀ®Èoàthem , c dÛ¢'
t
 
grow
 
w™h
 
šputsize


689 #Accu¿cy / 
Time
 -- 
R©io
.. 
mÜe
 
accu¿‹
 
w™h
 
Ëss
 
time
, 
thª
 
şasiÿl


691 #I 
ã–
 
like
 
we
 
could
 
basiÿÎy
 
ju¡
 
ü—‹
 
tho£
 
v¬Çmes
 
dyÇmiÿÎy
 
ba£d
 
Ú
 
numb”
 
of
 
cŞumns


692 #And 
Ëngth
 
of
 
cŞumns
 oà
cour£


694 #»äesh 
Ú
 
quªtum
 
com¶ex™y
 
şas£s
...
comm™t›
 
wl
 
ask


701 
NEW
 
STUFF
 
H
 
³ÇÉy


703 
we
 
have
 
Úly
 0 
š
 
our
 
´ec
 
li¡
 
to
 
’su»
 
™
's‡ 1 or 0

704 
our
 
Ãw
 
b
 
is
 
a
 
veùÜ
 
of
 
Ëngth
 1 
w™h
 
Úly
‡ 1 
š
 
™
, 
this
 
’su»s


705 
Úly
 
Úe
 
of
 
our
 
v¬ŸbËs
 
wl
 
be
 
a
 1

706 
we
 
muÉly
 
a
 
row
 
of
 
A
 
by
 
b
 oà
size
 1

707 
a
 
is
‡ 1 
x
 
k


710 #°ğ
v
.
sh­e
[0]

711 
´ec_li¡2
 = [0] #®È
v¬ŸbËs
 
¬e
 
bš¬y
, 
DO
 
NOT
 
CHANGE
 
VALUE


712 
b2
 = 
Å
.
	$¬¿y
([1]è#Thi 1 
’fÜûs
 
Úly
 
Úe
 
v¬ŸbË
 
to
 
be
 
a
 1 :
D


713 
v¬Çmes2
 = 
	$li¡
()

714 
d–2
 = 15 #Ïg¬ªg
muÉl›r


715 
Q_®t2
 = {
	}
} #Ãw 
diù
 
Q_®t
 
but
 
diff
 
key
 
Çmes


717 
´št
("Applying H…enalties...\n")

718 #Mak
as
 
mªy
 
q_®t2s
‡ 
th”e
 
¬e
 
cŞumns
 
š
 
H


719 
h_i
 
š
 
	$¿nge
(0, 
n
): #row

720 
v¬Çmes2
 = []

721 
h_j
 
š
 
	$¿nge
(0, 
k
): #col

722 
v¬Çmes2
.
	`­³nd
('h'+
	`¡r
Ğ(
h_j
+1èè+ sŒĞ(
h_i
+1) ))

723 #µršt.
	`µršt
(
v¬Çmes2
)

725 
A
 = 
Å
.
	$z”os
([1,
k
])

726 
A
 += 1

727 #µršt.
	`µršt
(
v¬Çmes2
)

728 
Q2
, 
Q2_®t
, 
šdex
 = 
	$qubo_´•_nÚÃg
(
A
, 
b2
, 
k
, 
´ec_li¡2
, 
v¬Çmes
=
v¬Çmes2
)

730 #µršt.
	`µršt
(
Q2_®t
)

731 #MuÉly 
ev”ythšg
 
by
 
d–


732 
key
,
v®ue
 
š
 
Q2_®t
.
	$™ems
():

733 #E¿£ 
®l
 
the
 
ch¬aù”s
 
š
h
key
 
aá”
 
und”scÜe


734 
‹mp_key
 = (
key
[0].
	`¥l™
('_')[0],key[1].split('_')[0])

735 
Q_®t2
[
‹mp_key
] = 
v®ue
*
d–2


737 
	`´št
("H Penalties: \n")

738 
µršt
.
	$µršt
(
Q_®t2
)

740 
	`´št
("Adding‡ll datao Q_total...\n")

741 #Add 
®l
 
to
 
Q_tÙ®
 
H


742 
key
, 
v®
 
š
 
Q_®t2
.
	$™ems
():

743 
key
 
š
 
Q_tÙ®
:

744 
Q_tÙ®
[
key
] +ğ
v®


746 
Q_tÙ®
[
key
] = 
v®


749 #µršt.
	`µršt
(
Q_®t2
)

751 #µršt.
	`µršt
(
Q_tÙ®
)

754 #§m¶”2 = 
dimod
.
	`ExaùSŞv”
()

755 #§m¶e£t2 = 
§m¶”2
.
	`§m¶e_qubo
(
Q_®t2
)

756 #§m¶e£t2 = 
§m¶”2
.
	`§m¶e_qubo
(
Q_tÙ®
)

758 
	`´št
("Sampling QUBO...\n")

759 #Thi 
is
 
wh”e
 
the
 
quªtum
 
p›û
 
h­³ns


760 
num_sw“ps
 = 30000

761 
num_»ads
 = 3000

763 
§m¶”
 = 
Ã®
.
	$SimuÏ‹dAÂ—lšgSam¶”
()

764 
§m¶e£t
 = 
§m¶”
.
	$§m¶e_qubo
(
Q_tÙ®
, 
num_sw“ps
òum_sw“ps, 
num_»ads
=num_reads)

766 
sŞutiÚ_diù
 = {
	}
}

767 
sŞutiÚ_diù
 = 
§m¶e£t
.
fœ¡
.
§m¶e


768 #sŞutiÚ_diù = 
§m¶e£t2
.
fœ¡
.
§m¶e


770 ## 
This
 
is
 
the
 
v”ifiÿtiÚ
 
·¹


772 
W
 = 
Å
.
	$z”os
([
p
,
k
])

773 #W = 
Å
.
	`Œª¥o£
(
W
)

774 
H
 = 
Å
.
	$z”os
([
k
,
n
])

775 #H = 
Å
.
	`Œª¥o£
(
H
)

778 
	`´št
("Creating verification W‡nd H...\n")

779 
i
 
š
 
	$¿nge
(0,
k
):

780 
j
 
š
 
	$¿nge
(0,
n
):

781 
‹mp_h
 = "h" + 
	`¡r
(
i
+1è+ sŒ(
j
+1)

782 
H
[
i
,
j
] = 
sŞutiÚ_diù
[
‹mp_h
]

784 
i
 
š
 
	$¿nge
(0,
p
):

785 
j
 
š
 
	$¿nge
(0,
k
):

786 
‹mp_w
 = "w" + 
	`¡r
(
i
+1è+ sŒ(
j
+1)

787 
sŞ_key
, 
sŞ_v®
 
š
 
sŞutiÚ_diù
.
	$™ems
():

788 
‹mp_w
 
š
 
sŞ_key
:

789 #´št(
‹mp_w
, 
sŞ_key
)

790 
‹mp_¡r
 = 
sŞ_key
.
	`¥l™
('_')[1]

791 #´št(
‹mp_¡r
)

792 
‹mp_¡r
 == "null":

793 
W
[
i
,
j
] +ğ-(2**(
´ec_li¡
[0]+1))*
sŞ_v®


795 
W
[
i
,
j
] +ğ(2**(
‹mp_¡r
))*
sŞ_v®


799 #´št(
§m¶e£t
)

800 
	`´št
("\n--- Verification ---\n")

801 
	`´št
("d–1: ", 
d–
, "\nd–2: ", 
d–2
)

802 
	`´št
("Num Clu¡”s: ", 
k
, "\n")

803 #´št("knowÀW: \n", 
w_‹¡
)

804 #´št("KnowÀH: \n", 
h_‹¡
)

805 #´št("KnowÀWH: \n", 
v_‹¡
)

807 
	`´št
("\n------\n")

810 
	`´št
("V (Œª¥o£dèğ\n", 
v
, "\n")

811 
	`´št
("V Sh­Ñ¿n¥o£d): " , 
v
.
sh­e
)

812 
	`´št
("\nCompu‹d W = \n", 
W
, "\n")

813 
	`´št
("W Sh­e: ", 
W
.
sh­e
)

814 
	`´št
("\nCompu‹d H = \n", 
H
, "\n")

815 
	`´št
("H Sh­e: ", 
H
.
sh­e
)

816 
	`´št
("\nCompu‹d WH = \À", 
Å
.
	$m©mul
(
W
,
H
))

817 
	`´št
("WH Sh­e: ", 
Å
.
	`m©mul
(
W
,
H
).
sh­e
, "\n")

818 
	`´št
("\nFœ¡ƒÃrgy: ", 
§m¶e£t
.
fœ¡
.
’”gy
)

820 
	`´št
("NÜm: ", 
LA
.
	`nÜm
(
v
 - 
Å
.
	$m©mul
(
W
,
H
)))

821 
	`´št
("V”ifyšg be¡ƒÃrgy vŸ Frob’iu NÜm: ", 
LA
.
	`nÜm
(
v
, 'fro')**2, "\n")

823 
	`´št
("Numb” oà§m¶es: ", 
v
.
sh­e
[1])

824 
	`´št
("RuÂšgime: ", 
d©‘ime
.
	`now
()-
¡¬t_time
, "\n")

825 
	`´št
("")

826 
	$couÁ_Úes
(
H
)

827 
	`´št
("")

832 
PlÙtšg
 
Code


837 #¶Ù 
the
 3 
şu¡”s


838 
¶t
.
	`sÿ‰”
(

839 
X
[
y_km
 == 0, 0], X[y_km == 0, 1],

840 
s
=50, 
c
='lightgreen',

841 
m¬k”
='s', 
edgecŞÜ
='black',

842 
Ïb–
='cluster 1'

845 
¶t
.
	`sÿ‰”
(

846 
X
[
y_km
 == 1, 0], X[y_km == 1, 1],

847 
s
=50, 
c
='orange',

848 
m¬k”
='o', 
edgecŞÜ
='black',

849 
Ïb–
='cluster 2'

852 
¶t
.
	`sÿ‰”
(

853 
X
[
y_km
 == 2, 0], X[y_km == 2, 1],

854 
s
=50, 
c
='lightblue',

855 
m¬k”
='v', 
edgecŞÜ
='black',

856 
Ïb–
='cluster 3'

859 #¶Ù 
the
 
ûÁroids


860 
¶t
.
	`sÿ‰”
(

861 
km
.
şu¡”_ûÁ”s_
[:, 0], km.cluster_centers_[:, 1],

862 
s
=250, 
m¬k”
='*',

863 
c
='»d', 
edgecŞÜ
='black',

864 
Ïb–
='centroids'

867 
¶t
.
	$Ëg’d
(
sÿ‰”pošts
=1)

868 
¶t
.
	$grid
()

869 
¶t
.
	`show
()

876 
FÜ
 
‹¡šg
, 
make
 
up
 
a
 
WH
 
ªd
 
g‘
‡ 
»suÉ
 
of
 
V
, 
th’
 
‹¡


877 
Make
 
su»
 
to
 
put
 
this
 
š
 
dis£¹©iÚ
 
as
 
‹¡


880 
V
 = 
p
 
x
 
n


881 
W
 = 
p
 
x
 
k


882 
H
 = 
k
 
x
 
n


884 
V
 = 2 
x
 2

885 
W
 = 2 
x
 2

886 
H
 = 2 
x
 2

889 
W
 
H
 = 
V


894 
lš—riz©iÚ
 
³ÇÉy
 =ğ
Ïg¬ªge
 
muÉl›r


895 
w11h11
 = 
x1
 + 2(w11h11 - 2x1(
w11
 + 
h11
) + 3x1)

896 
P’©ly
 
p›û
 = 2(
w11h11
 - 2x1(
w11
 + 
h11
) + 3x1)

897 
NÙ
 
messšg
 
w™h
 
pow”s
 
of
 2

898 
have
 
to
 dØ
this
 
³ÇÉy
 
ev”y
 
b™
 
th©
 
makes
 
up
 
w
 
v®ue
..

900 
Onû
 
the
 
³ÇÉy
 
is
 
­¶›d
, 
we
 
th’
 
‹¡
 
™
 
by
 
subm™tšg
 
to
h
sŞv”
, 
a
 
known


901 
WH
 
w™h
 
a
 
V
, 
ªd
 
we
 
g‘
 
şo£
, w
ÿn
 
v”ify
 
this
.

908 
IÁ”´‘©iÚ
 
of
 
»suÉs
:

910 
—ch
 1 
š
 
cŞumn
 
of
 
H


912 
row
 
shows
 
which
 
şu¡”
 
™
 
b–Úgs
 
to


913 
cŞumn
 
d’Ùes
 
the
 
d©­ošt


915 
In
 
mo¡
 
ÿ£s
 
V
 !ğ
WH
 
but
 
wl
 
be
 
as
 
şo£
‡ 
possibË


917 
Wh’
 
you
 
muÉly
 
by
 
a
 
cŞumn
 
vec
 
	$§y
 (0 1)
T


918 1 -4 
X
 0

921 
CŞumn
 
š
 
W
 
mu¡
 
be
 
§me
 
Ëngth
 
as
 
cŞumns
 iÀ
V


923 
We
 
mu¡
 
Œª¥o£
 
šput
 
äom
 
make_blobs
 
our
 
m©rix
 
çtÜfiz©iÚ
 
¡uff


925 
The
 
Ëngth
 
of
 
the
 
veùÜ
 oàth
šput
 
d©a
 
d‘”mšes
hËngth oàthd©¨
š
h
	`ûÁ”s
 (
coz
 
they
 
r
 
cut
 
äom
h
§me
 
şÙh
 
so
 
to
 
¥—k
).

926 
Rememb”
 
this
. 
NÙe
 
you
 
have
 
to


929 
Make_blobs
 
giv’
 
d©a
, 
we
 
give
 
™
 
known
 
ûÁ”
 
pošts
 
th©
 
¬e
 
š‹g”s
, 
so
 w
ÿn
 
£e
 
how
 
şo£
 w
g‘
 
to
 
them
 
w™h
 
our
 
®gÜ™hm
 
com·risÚ


931 
IÅut
 
§m¶es
 
MUST
 
be
 
Œª¥o£d
 
äom
 
make_blobs
 
to
 
wÜk
 
´İ”ly
, 
this
 
makes
 
our
 sam¶e 
što
 
cŞumns
 
š¡ad
 
of
 
rows


	@toyproblem.py

1 
impÜt
 
numpy
 
as
 
Å


2 
impÜt
 
cİy


3 
impÜt
 
dimod


4 
impÜt
 
¿ndom


5 
impÜt
 
m©h


6 
äom
 
m©h
 
impÜt
 
log


7 
impÜt
 
dimod


8 
impÜt
 
	gm©¶Ùlib
.
py¶Ù
 
as
 
¶t


9 
äom
 
	gskË¬n
.
d©a£ts
 
impÜt
 
make_blobs


10 
äom
 
	gskË¬n
.
şu¡”
 
impÜt
 
	gKM—ns


14 #CÚv”ˆ||
V
-
WH
|| 
´obËm
 
to
 
QUBO


15 #v = 
IÅut
 
M©rix
 
of
 
our
 
§m¶es
 
as
 
Å
.
¬¿y


16 #w = 
IÅut
 
m©rix
 
th©
 
cÚšs
 
Clu¡”ed
 
Sam¶es
, 
—ch
 
cŞumn
 
veùÜ
 
is
 
a
 
şu¡”


17 #h = 
Bš¬y
 
veùÜ
, 
such
 
th©
 
ev”y
ƒv”y "1" 
v®ue
 
is
 
the
 
ûÁroid


18 #Àğ
Ëngth
 
of
 
cŞumn
 
veùÜ
 
x


19 #b™¥ow” - 
diù
 
cÚšg
 
pow”s
 
of
 2, 
­¶›d
 
š
 2's compliment-like

20 #Ouuˆ- 
QDiù
 
a
 
diùiÚ¬y
 
cÚššg
 
the
 
QUBO
 
fÜmuÏtiÚ


21 #diù 
wl
 
be
 (
u
,
v
è: 
b
 
wh”e
 (u,vè
¬e
 
bš¬y
 
v¬ŸbËs
 
ªd
 b 
is
 
bŸs


23 ###W 
Cªdid©e
 
ûÁ”s
, ###
## 
Each
 
cŞumn
 
is
 
a
 
şu¡”
, 
ev”y
 
two
 
rows
 = 
x
 
ªd
 
y
 
coÜdš©es


25 #####
#### 
SAMPLES
 ###


29 
Exam¶e
 
pcode
 
·³r


31 
Giv’
 
V


32 
Fšd
 
	gW
, 
H


34 
	gRadix
-2

38 
	gQUBOP»p


45 
	gmaš


48 
	gQ
 :ğ
	$quboP»p
(
W
,
H
,
b™sPow”
)

50 
S
 :ğ
	$QuªtumQUBOSŞv”
(
Q
)

52 
S
 :ğS.
fœ¡_§m¶e


54 
S
 :ğ
	`Po¡Proûss
(S)

63 --- 
SamµË
 
V
 
M©rix
 ---

65 
p
 
x
 
n
 == 10 x 2

80 --- 
Sam¶e
 
W
 
M©rix
 ---

82 
n
 
x
 
k
 = 2 x 2

87 
w11
 
w12


88 
w21
 
w22


91 --- 
Sam¶e
 
H
 
M©rix
 ---

93 
k
 
x
 
p
 = 2 x 10

95 ** 
BINARY
 
MATRIX
 ***

96 ** 
OÆy
 
a
 
sšgË
 '1' 
³r
 
cŞumn


97 ** 
Each
 '1' 
is
 
the
 'vÙe' 
Ú
h
be¡
 
ûÁ”


103 
h00
 
h01
 
h02
 
h03
 
h04
 
h05
 
h06
 
h07
 
h08
 
h09


104 
h10
 
h11
 
h12
 
h13
 
h14
 
h15
 
h16
 
h17
 
h18
 
h19


107 
muÉliÿtiÚ
 =ğ
dÙ
 
´oduù


112 
def
 
	$make_qubo
(
v
,
w
,
h
,
n
,
b™¥ow”
):

114 
pow”sTwo
 = 
Å
.
	`z”os
(
	`Ën
(
b™¥ow”
)+1)

116 #D—È
w™h
 
pow”s
 
of
 
two


117 
i
 
š
 
	`¿nge
(0, 
	`Ën
(
b™¥ow”
)+1):

118 
i
 == 0:

119 
pow”sTwo
[
i
] = (2**(
b™¥ow”
[i]+1)) * (-1)

121 
pow”sTwo
[
i
] = 2**(
b™¥ow”
[i-1])

123 
Qš™
 = 
Å
.
	$z”os
([
n
,n])

124 
Qdiù
 = {
	}
}

126 #W 
is
 
our
 
unknowns
 
to
 
be
 
found
 
by
 
ªÃ®šg


127 #Each 
’Œy
 
š
 
W
 
has
 
our
 
¿dix
-2 
‹chnique
 
­¶›d


128 #Each 
’Œy
 
š
 
W
 = [-8
w
 4w 2w 1w ]

129 #th
QUBO
 
fÜm
 
is
 -8
w
 + 4w + 2w + 1w

137 #CÚv”ˆ
diù
 
to
 
bš¬y
 
¡ršg


141 #Puˆ
bš¬y
 
¡ršg
 
što
 
Å
.
¬¿y
 
veùÜ


147 #scik™ 
Ë¬n
 
¡uff
.. 
´•


149 
¡¬t_ûÁ”s
=
Å
.
¬¿y
([(2,2),(5,5)])

151 
	gX
, 
	gy
 = 
make_blobs
(

152 
n_§m¶es
=10, 
n_ã©u»s
=2,

153 
ûÁ”s
=
¡¬t_ûÁ”s
, 
şu¡”_¡d
=0.5,

154 
shufæe
=
True
, 
¿ndom_¡©e
=0

160 
¶t
.
sÿ‰”
(
X
[:,0], X[:,1], 
s
=50,
c
='blue', 
m¬k”
='o', 
edgecŞÜ
='black')

162 #PlÙ 
ûÁroids


163 
¶t
.
sÿ‰”
(
ûÁ”s
[0,:], c’‹rs[1,:], 
s
=250, 
m¬k”
='*', 
c
='»d', 
edgecŞÜ
='bÏck', 
Ïb–
='centroids')

165 
¶t
.
	$Ëg’d
(
sÿ‰”pošts
=1)

166 
¶t
.
	$grid
()

167 
¶t
.
	`show
()

170 #-- 
Te¡šg
 
¬—
 -- #
## 
Ax
 - 
b
 ##

173 ## 
In
 
this
 
fœ¡
 
exam¶e
 
know
 
the
 
sŞutiÚ
 
w12ªd
 
x2
, 
which
 
is
 
x1
=0, x1=1

175 
A
 = 
Å
.
	$¬¿y
([ [2,1], [1,3] ])

176 
b
 = 
Å
.
	$¬¿y
([1,3])

178 #Qub˜
diùiÚ¬y
, 
qn
 
m—ns
 
qubibi
 #
 = {}

181 #Individu® 
cÛffic›Ás
 
h”e


182 #Ba£d 
Ú
 
the
 
L2
 
NÜm
, 
wh”e
 , 
we
 
squ¬e
h
xam¶e
 
above


183 ## ||
Ax
 - 
b
||^2

187 
	gQ
['q0','q0'] = 
A
[0,0] * (
	gA
[0,0] - 2*
	gb
[0]) + A[1,0] * (A[1,0] - 2*b[1])

188 
	gQ
['q1','q1'] = 
A
[0,1] * (
	gA
[0,1] - 2*
	gb
[0]) + A[1,1] * (A[1,1] - 2*b[1])

190 #IÁ”©iÚ 
b‘w“n
 
qub™s
 0 
ªd
 1 
as
 
QUBO


191 
	gQ
['q0','q1'] = 2 * (
A
[0,0] * 
	gA
[0,1] + A[1,0] * A[1,1])

193 
´št
("-- Our current Qubo setup ---")

194 
	$´št
(
Q
)

196 #L‘ 
us
 
Œy
 
the
 
exÿt
 
sŞv”


198 
§m¶”
 = 
dimod
.
	$ExaùSŞv”
()

200 
§m¶e£t
 = 
§m¶”
.
	$§m¶e_qubo
(
Q
)

202 #G‘ 
be¡
 
’”gy


204 
	`´št
("ResuÉ is: ", 
§m¶e£t
.
fœ¡
.
§m¶e
)

206 ###SecÚd 
exam¶e
 ###


208 ## 
Fœ¡
 
was
 
—sy
, 
now
 
we
 
Ãed
 
to
 
focus
 
Ú
 
quad¿tics


210 #Fšd 
x0
, 
x1
, 
x2
 
such
 
th©
 
we
 
	`mšimize
 (2 - x2 - 
w12
-x0)^2

211 #W
know
 
gošg
 
š
, 
the
 
be¡
 
sŞutiÚ
 
wl
 
have
 2 
v¬ŸbËs
 = 1

213 #(2 - 
x2
 - 
w12
- 
x0
)^2 =

214 #x0^2 + 
x1
^2 + 
x2
^2 + 2(-
x0
)(-x1) + 2(-x1)(-x2) + 2(-x0)(-x2) + 2(2)(-x0) + 2(2)(-x1) + 2(2)(-x2) + 4

216 #x0^2 = 
x0
, 
x1
^2 = x1, 
x2
^2 = x2 .. 
so
 
this
 
is
 
the
 
§me
 
as


218 #1(1-2(2)
x0
 - 1(1-2(2))
w12
- 1(1-2(2))
x2
 + 2x0w12+ 2x1x2 + 2x0x2 + 4

220 ## 
L‘s
 
make
 
this
 
što
 
a
 
QUBO


222 
Q2
 = {
	}
}

224 
Q2
['x0','x0'] = 1 * (1-2*(2))

225 
Q2
['x1','x1'] = 1 * (1-2*(2))

226 
Q2
['x2','x2'] = 1 * (1-2*(2))

228 #Ou¸
quad¿tic
 
cÛffic›Ás
 / 
š‹¿ùiÚs


229 
Q2
['x0','x1'] = 2

230 
Q2
['x0','x2'] = 2

231 
Q2
['x1','x2'] = 2

233 
	$´št
(
Q2
)

235 #Ëˆ
us
 
sŞve
 
w™h
 
exaùsŞv”


237 
§m¶e£t2
 = 
§m¶”
.
	$§m¶e_qubo
(
Q2
)

239 
	$´št
(
§m¶e£t2
)

241 
	`´št
("ResuÉ is: ", 
§m¶e£t2
.
fœ¡
.
§m¶e
)

243 
k
,
v
 
š
 
Q
.
	$™ems
():

244 
	$´št
(
k
,
v
)

247 
	`´št
("\n\n ----- Binary vector ----\n")

249 #now 
we
 
have
 
a
 
bš¬y
 
veùÜ
 
w™h
 3 
unknowns
, 
x0
, 
x1
, 
ªd
 
x2


250 #L‘ 
us
 
	`mšimize
 (3 + 4x2 - 2
w12
- 
x0
)^2

251 #W
ÿn
 
‹Î
 
our
 
ªsw”
 
by
 
lookšg
, 
x0
 = 1, 
w12
ğ1 , 
x2
 = 0

252 ## 
But
 
cÚv”t
 
this
 
to
 
QUBO


254 #(3 + 4x2 - 2
w12
- 
x0
)^2 =

255 #(4x2)^2 + 2x1^2 + 
x0
^2 + 2(4x2(-2x1) + 2(-2x1)(-x0) + 2(4x2)(-x0) + 2(3)(4x2) + 2(3)(-2x1) + 2(3)(-x0) + 9

256 #QubØ
we
 
ÿn
 
ignÜe
 
the
 
cÚ§Á
, 
which
 
is
 9

257 #
3 = {}

259 
	gQ3
['x0','x0'] = 1*(1-2*(3))

260 
Q3
['x1','x1'] = 2*(2-2*(3))

261 
Q3
['x2','x2'] = 4*(4+2*(3))

263 
Q3
['x0','x1'] = 2 * (2)

264 
Q3
['x0','x2'] = -2 * (4)

265 
Q3
['x1','x2'] = -2 * (8)

267 
k
,
v
 
š
 
	gQ3
.
	$™ems
():

268 
	$´št
(
k
,
v
)

270 
§m¶e£t3
 = 
§m¶”
.
	$§m¶e_qubo
(
Q3
)

271 
	$´št
(
§m¶e£t3
)

272 
	$´št
(
§m¶e£t3
.
fœ¡
.
§m¶e
)

276 ## 
Ok
 
Ëts
 dØ
ªÙh”
 
w™h
 8 
unknowns
 
x0
 - 
x7


278 (2 + 
x0
 - 4
w12
+ 2x4 + 3x3 - 
x4
 - 6x7 + 
x5
 + 9x6 - 5x2)^2

280 {'x0': 1, 'x1': 1, 'x2': 0, 'x3': 0, 'x4': 0, 'x5': 1, 'x6': 0, 'x7': 0
	}
}

284 
Ex·nded
:

287 4 
x0


288 + 
x0
^2

289 - 16 
x1


290 - 8 
x0
 
x1


291 + 16 
x1
^2

292 - 20 
x2


293 - 10 
x0
 
x2


294 + 40 
w12x2


295 + 25 
x2
^2

296 + 12 
x3
 +

297 6 
x0
 
x3


298 - 24 
w12x3


299 - 30 
x2
 
x3


300 + 9 
x3
^2

301 + 4 
x4


302 + 2 
x0
 
x4


303 - 8 
w12x4


304 - 10 
x2
 
x4


305 + 6 
x3
 
x4


306 + 
x4
^2

307 + 4 
x5


308 + 2 
x0
 
x5


309 - 8 
w12x5


310 - 10 
x2
 
x5


311 + 6 
x3
 
x5


312 + 2 
x4
 
x5


313 + 
x5
^2

314 + 36 
x6


315 + 18 
x0
 
x6


316 - 72 
w12x6


317 - 90 
x2
 
x6


318 + 54 
x3
 
x6


319 + 18 
x4
 
x6


320 + 18 
x5
 
x6


321 + 81 
x6
^2

322 - 24 
x7


323 - 12 
x0
 
x7


324 + 48 
w12x7


325 + 60 
x2
 
x7


326 - 36 
x3
 
x7


327 - 12 
x4
 
x7


328 - 12 
x5
 
x7


329 - 108 
x6
 
x7


330 + 36 
x7
^2

332 
Sim¶if›d
:

334 (2 + 
x0
 - 4 
w12
- 5 
x2
 + 3 
x3
 + 
x4
 + 
x5
 + 9 
x6
 - 6 
x7
)^2

336 
SŞutiÚ
:

338 
x0
 = 0

339 
w12
= 1

340 
x2
 = 1

341 
x3
 = 0

342 
x4
 = 0

343 
x5
 = 0

344 
x6
 = 0

345 
x7
 = 1

347 
Drİ
 
cÚ¡ªts
, 2 
š
 
this
 

349 
Bš¬y
 
v¬ŸbËs
 
	gidempÙ’t
, 
	g›
: 
x0
^2 = x0

354 
Q4
 = {}

356 #lš—¸
cÛffic›Ás


357 
Q4
['x0', 'x0'] = 5 #4
x0
 + x0^2

358 
Q4
['x1', 'x1'] = (-16+16)

359 
Q4
['x2', 'x2'] = (-20+25)

360 
Q4
['x3', 'x3'] = 21 #12x3 + 9x3

361 
Q4
['x4', 'x4'] = 5 #4
x4
 + 1x4^2

362 
Q4
['x5', 'x5'] = 5 #4
x5
 + 1x5^2

363 
Q4
['x6', 'x6'] = (36+81) #36x6 + 81x6^2

364 
Q4
['x7', 'x7'] = (-24+36) #-24x7 + 36x7^2

366 #Quad¿tiø
CÛffic›Ás


367 
Q4
['x0', 'x1'] = -8

368 
Q4
['x0', 'x2'] = -10

369 
Q4
['x0', 'x3'] = 6

370 
Q4
['x0', 'x4'] = 2

371 
Q4
['x0', 'x5'] = 2

372 
Q4
['x0', 'x6'] = 18

373 
Q4
['x0', 'x7'] = -12

374 
Q4
['x1', 'x2'] = 40

375 
Q4
['x1', 'x3'] = -24

376 
Q4
['x1', 'x4'] = -8

377 
Q4
['x1', 'x5'] = -8

378 
Q4
['x1', 'x6'] = -72

379 
Q4
['x1', 'x7'] = 48

380 
Q4
['x2', 'x3'] = -30

381 
Q4
['x2', 'x4'] = -10

382 
Q4
['x2', 'x5'] = -10

383 
Q4
['x2', 'x6'] = -90

384 
Q4
['x2', 'x7'] = 60

385 
Q4
['x3', 'x4'] = 6

386 
Q4
['x3', 'x5'] = 6

387 
Q4
['x3', 'x6'] = 54

388 
Q4
['x3', 'x7'] = -36

389 
Q4
['x4', 'x5'] = 2

390 
Q4
['x4', 'x6'] = 18

391 
Q4
['x4', 'x7'] = -12

392 
Q4
['x5', 'x6'] = 18

393 
Q4
['x5', 'x7'] = -12

394 
Q4
['x6', 'x7'] = 18

397 #fÜ 
k
,
v
 
š
 
Q4
.
™ems
():

398 #´št(
k
,
v
)

400 
	g§m¶e£t4
 = 
§m¶”
.
	$§m¶e_qubo
(
Q4
)

401 #´št(
§m¶e£t4
)

402 
	`´št
("ResuÉ w™h 8 unknowns: ", 
§m¶e£t4
.
fœ¡
.
§m¶e
)

406 ## 
Ok
 
now
 
Ët
 
us
 
Œy
 
this
 
V
=
WH


407 ## 
W
 
ªd
 
H
 
¬e
 
unknowns
 ##

411 
G’”®
 
Info
 
about
 
NMF
, 
nÙ
 
u£d
 
this
 
fÜmuÏtiÚ
, 
but
 u£d 
»ã»nû


412 
V
 = 
WH


414 
V_i
 = 
Wh_i


416 
wh”e
 
V_i
 = 
i
 
cŞumn
 
veùÜ
 
of
 
the
 
´oduù
 
m©rix
 
V
 
ªd
 
h_i
 
is
h˜cŞumÀveùÜ m©rix 
H


419 -- 
This
 
is
 
³r
 
™”©iÚ
 
of
 
the
 
®gÜ™hm
 --

420 -- 
DÚe
 
³r
 
–em’t
 ---

421 -- 
W
 
ªd
 
H
 
¬e
 
š™Ÿlized
 
to
 
some
 
nÚ
 
Ãg©ive
 
v®ues
 --

422 -- ^
T
 = 
Œª¥o£
, 
_
[
ij
] = 
cu¼’t
 
–em’t
, 
n
 = cu¼’ˆ
™”©iÚ
,‚+1 = 
Ãxt
 
™”©š


424 
H
^(
n
+1)
_
[
ij
] = H^
n_
[ij] * (
W
^n)^
T_
[ij] * 
V_
[ij] / (W^n)_[ij]^
T
 * W^n_[ij] * H^n_[ij]

426 
W
^(
n
+1)
_
[
ij
] = W^
n_
[ij] * 
V_
[ij] * 
H
^Ò+1)_[ij]^
T
 / W^n_[ij] * H^(n+1)_[ij] * H^(n+1)_[ij]^T

430 Ğ(
w1h1
 + 
w2h3
è+ (
w1h2
 + 
w2h4
è+ (
w3h1
 + 
w4h3
è+ (
w3h2
 + 
w4h4
) )^2 =

432 #thªk 
M©hem©iÿ
 
Ex·nd
!

434 
w1h1
^2 + 2*w1h1 
w1h2
 + w1h2^2 + 2*w1h1 
w2h3
 + 2*w1h2*w2h3 + w2h3^2 +

435 2*
w1h1
 
w2h4
 + 2*
w1h2
*w2h4 + 2*
w2h3
 w2h4 + w2h4^2 + 2*w1h1 
w3h1
 +

436 2*
w1h2
*
w3h1
 + 2*
w2h3
 w3h1 + 2*
w2h4
 w3h1 + w3h1^2 + 2*
w1h1
 
w3h2
 +

437 2*
w1h2
*
w3h2
 + 2*
w2h3
 w3h2 + 2*
w2h4
 w3h2 + 2*
w3h1
 w3h2 + w3h2^2 +

438 2*
w1h1
 
w4h3
 + 2*
w1h2
*w4h3 + 2*
w2h3
 w4h3 + 2*
w2h4
 w4h3 +

439 2*
w3h1
 
w4h3
 + 2*
w3h2
*w4h3 + w4h3^2 + 2*
w1h1
 
w4h4
 + 2*
w1h2
*w4h4 +

440 2*
w2h3
 
w4h4
 + 2*
w2h4
 w4h4 + 2*
w3h1
 w4h4 + 2*
w3h2
*w4h4 +

441 2*
w4h3
 
w4h4
 + w4h4^2

447 -- 
In
 
the
 
·³r
, 
we
 
u£
 
w11
 
ªd
 
h11
.. 
but
 
this
 w
wl
 u£ w11 - 
x7
 
as
 
unknowns


449 
We
 dØ
the
 
nÜm
 
of
 ||
V
-
WH
||^2

450 
w11
^2 = w11 , 
idempÙ’cy


452 
This
 
is
 
wh©
 
bšds
 
the
 
v®ues
 
š
 
V
 
to
 
WH


455 
V
 
W
 
H


456 [1,2] [
w11
, 
w12
] [
h11
, 
h12
]

457 [3,4] [
w21
, 
w22
] [
h21
, 
h22
]

460 
WH


461 [ 
w11h11
 + 
w12h21
, 
w11h12
 + 
w12h22
 ]

462 [ 
w21h11
 + 
w22h21
, 
w21h12
 + 
w22h22
 ]

465 
V
 - 
WH
 =

467 [ 1-
w11
 
h11
-
w12h21
 2-w11 
h12
-
w12h22
 ]

468 [ 3-
w21
 
h11
-
w22
 
h21
 4-w21 
h12
-w22 
h22
 ]

470 ||
V
-
WH
||^2
_2
 =

472 Ğ(1-(
w11
*
h11
)-(
w12
*
h21
))^2 + (2-(w11*
h12
)-(w12*
h22
))^2 + (3-(
w21
*h11)-(
w22
*h21))^2 + (4-(w21*h12)-(w22*h22))^2 )

475 -- 
Ex·nded
 ---

477 
w
^2 = w ..
‘c
 
idempÙ’t


480 -2 
h11
 
w11


481 -4 
h12
 
w11


482 +
h11
^2 
w11
^2

483 +
h12
^2 
w11
^2

484 -2 
h21
 
w12


485 -4 
h22
 
w12


486 +2 
h11
 
h21
 
w11
 
w12


487 +2 
h12
 
h22
 
w11
 
w12


488 +
h21
^2 
w12
^2

489 +
h22
^2 
w12
^2

490 -6 
h11
 
w21


491 -8 
h12
 
w21


492 +
h11
^2 
w21
^2

493 +
h12
^2 
w21
^2

494 -6 
h21
 
w22


495 -8 
h22
 
w22


496 +2 
h11
 
h21
 
w21
 
w22


497 +2 
h12
 
h22
 
w21
 
w22


498 +
h21
^2 
w22
^2

499 +
h22
^2 
w22
^2

502 --- 
Sim¶if›d
 ---

504 (-1 + 
w11
 
h11
 + 
w12h21
)^2 + (-3 + 
w21
 h11 + 
w22
 
h21
)^2 + (-2 + w11 
h12
 + 
w12h22
)^2 + (-4 + w21 h12 + w22 
h22
)^2

508 #8 
unknowns


509 
Q5
 = {
	}
}

511 #lš—¸
cÛffic›Ás


512 
Q5
['w11', 'w11'] =

513 
Q5
['w12', 'w12'] =

514 
Q5
['w21', 'w21'] =

515 
Q5
['w22', 'w22'] =

516 
Q5
['h11', 'h11'] =

517 
Q5
['h12', 'h12'] =

518 
Q5
['h21', 'h21'] =

519 
Q5
['h22', 'h22'] =

521 #Quad¿tiø
CÛffic›Ás


522 
Q5
['w11', 'w12'] =

523 
Q5
['w11', 'w21'] =

524 
Q5
['w11', 'w22'] =

525 
Q5
['w11', 'h11'] =

526 
Q5
['w11', 'h12'] =

527 
Q5
['w11', 'h21'] =

528 
Q5
['w11', 'h22'] =

529 
Q5
['w12', 'w21'] =

530 
Q5
['w12', 'w22'] =

531 
Q5
['w12', 'h11'] =

532 
Q5
['w12', 'h12'] =

533 
Q5
['w12', 'h21'] =

534 
Q5
['w12', 'h22'] =

535 
Q5
['w21', 'w22'] =

536 
Q5
['w21', 'h11'] =

537 
Q5
['w21', 'h12'] =

538 
Q5
['w21', 'h21'] =

539 
Q5
['w21', 'h22'] =

540 
Q5
['w22', 'h11'] =

541 
Q5
['w22', 'h12'] =

542 
Q5
['w22', 'h21'] =

543 
Q5
['w22', 'h22'] =

544 
Q5
['h11', 'h12'] =

545 
Q5
['h11', 'h21'] =

546 
Q5
['h11', 'h22'] =

547 
Q5
['h12', 'h21'] =

548 
Q5
['h12', 'h22'] =

549 
Q5
['h21', 'h22'] =

551 ## 
N“d
 
code
 
to
 dØ
the
 
pow”
 
of
 2 
­´oxim©iÚ
Ø
šput
 
d©a


552 ## 
šput
 
wl
 
be
 
a
 
æßtšg
 
pošt
 
Ü
 
š‹g”


553 ## 
æßtšg
 
pošt
, 
Ãed
 
to
 
round
 
down
Ø
š‹g”
, 
th’
 
­´oxim©e
 (
æoÜ
)

	@
1
.
1
/usr/include
11
166
4-5-2022.py
centers.py
dwave-test.py
kmeans.py
kmedoids.py
least-squares-qubo-example.py
quadratic.py
quadratic_automated.py
quantum-centers.py
qubo.py
toyproblem.py
